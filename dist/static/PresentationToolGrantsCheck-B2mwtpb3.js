const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/QRCodeSVG-CHDLHmKj.js","static/sanity-DvbbiBeV.js","static/LiveQueries-CyDYQ7HO.js","static/DisplayedDocumentBroadcaster-BJlIpq0U.js","static/PostMessageDocuments-DPQ8q5MZ.js","static/PostMessageRefreshMutations-Bvjuq0H3.js","static/PostMessagePerspective-5b6S4zjt.js","static/PostMessagePreviewSnapshots-IURQLBv7.js","static/PostMessageSchema-C9shHelp.js","static/PostMessageTelemetry-CRQ2NZFu.js"])))=>i.map(i=>d[i]);
import{b7 as Cr,r as f,b8 as kt,b9 as kr,j as l,ba as Ar,bb as Tr,bc as Wt,bd as Nt,be as Ft,bf as Vt,bg as Bt,bh as Kt,bi as Ht,bj as ft,bk as vt,bl as Oe,bm as Fe,bn as gt,bo as wt,bp as Be,bq as yt,br as xt,a2 as Gt,bs as Mr,bt as qt,bu as Ir,bv as Ur,d as L,bw as X,bx as Qt,by as $r,u as et,bz as Xt,bA as Jt,aF as Ke,k as tt,l as ge,bB as we,bC as Yt,bD as Zt,bE as er,bF as Lr,bG as tr,bH as Dr,Z as Or,bI as rr,p as Qe,bJ as dt,ay as zr,bK as Wr,bL as Nr,F as ie,bM as Fr,n as bt,bN as Y,bO as Vr,bP as pe,bQ as rt,bR as Br,bS as Kr,bT as Hr,bU as Gr,bV as qr,w as fe,bW as Pt,bX as St,bY as Qr,bZ as At,b_ as Xr,aa as _t,b$ as Jr,c0 as Yr,C as ue,c1 as nr,c2 as He,ak as Ee,i as Xe,T as Z,S as Ie,a4 as Je,e as Ye,c3 as Re,c4 as Zr,c5 as ar,c6 as en,c7 as tn,c8 as rn,a8 as nn,A as he,b as an,c9 as jt,ca as sn,cb as on,cc as nt,cd as cn,U as ln,N as un,ce as Ve,cf as ir,cg as dn,ch as pn,M as mn,ci as hn,D as fn,cj as vn,ck as gn,cl as sr,aK as wn,cm as yn,cn as xn,co as bn,a_ as Pn,K as Sn,cp as _n,aQ as or,cq as jn,az as cr,a$ as lr,cr as En,cs as Rn,ct as Cn,cu as kn,cv as An,cw as Tn,cx as Mn,cy as In,cz as Un}from"./sanity-DvbbiBeV.js";import{D as $n,i as Ln}from"./DisplayedDocumentBroadcaster-BJlIpq0U.js";function Dn({children:r,isValidProp:e,...t}){e&&Cr(e),t={...f.useContext(kt),...t},t.isStatic=kr(()=>t.isStatic);const a=f.useMemo(()=>t,[JSON.stringify(t.transition),t.transformPagePoint,t.reducedMotion]);return l.jsx(kt.Provider,{value:a,children:r})}const On={"handshake/syn":Ht,"handshake/syn-ack":Kt,"handshake/ack":Bt,"channel/response":Vt,"channel/heartbeat":Ft,"channel/disconnect":Nt,"overlay/focus":"visual-editing/focus","overlay/navigate":"visual-editing/navigate","overlay/toggle":"visual-editing/toggle","presentation/toggleOverlay":"presentation/toggle-overlay"},zn={[Ht]:"handshake/syn",[Kt]:"handshake/syn-ack",[Bt]:"handshake/ack",[Vt]:"channel/response",[Ft]:"channel/heartbeat",[Nt]:"channel/disconnect","visual-editing/focus":"overlay/focus","visual-editing/navigate":"overlay/navigate","visual-editing/toggle":"overlay/toggle","presentation/toggle-overlay":"presentation/toggleOverlay"},Wn=r=>{const{data:e}=r;return e&&typeof e=="object"&&"domain"in e&&"type"in e&&"from"in e&&"to"in e&&(e.domain==="sanity/channels"&&(e.domain=Wt),e.to==="overlays"&&(e.to="visual-editing"),e.from==="overlays"&&(e.from="visual-editing"),e.channelId=e.connectionId,delete e.connectionId,e.type=On[e.type]??e.type),r},Nn=r=>{const{channelId:e,...t}=r,a={...t,connectionId:e};return a.domain===Wt&&(a.domain="sanity/channels"),a.to==="visual-editing"&&(a.to="overlays"),a.from==="visual-editing"&&(a.from="overlays"),a.type=zn[a.type]??a.type,a.type==="channel/response"&&a.responseTo&&!a.data&&(a.data={responseTo:a.responseTo}),(a.type==="handshake/syn"||a.type==="handshake/syn-ack"||a.type==="handshake/ack")&&(a.data={id:a.connectionId}),a},Fn=({context:r},e)=>{const{sources:t,targetOrigin:a}=r,i=Nn(e.message);t.forEach(n=>{n.postMessage(i,{targetOrigin:a})})},pt=()=>({listen:Tr(Wn),requestMachine:Ar().provide({actions:{"send message":Fn}})}),ae=[];for(let r=0;r<256;++r)ae.push((r+256).toString(16).slice(1));function Vn(r,e=0){return(ae[r[e+0]]+ae[r[e+1]]+ae[r[e+2]]+ae[r[e+3]]+"-"+ae[r[e+4]]+ae[r[e+5]]+"-"+ae[r[e+6]]+ae[r[e+7]]+"-"+ae[r[e+8]]+ae[r[e+9]]+"-"+ae[r[e+10]]+ae[r[e+11]]+ae[r[e+12]]+ae[r[e+13]]+ae[r[e+14]]+ae[r[e+15]]).toLowerCase()}let it;const Bn=new Uint8Array(16);function Kn(){if(!it){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");it=crypto.getRandomValues.bind(crypto)}return it(Bn)}const Hn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Tt={randomUUID:Hn};function Gn(r,e,t){if(Tt.randomUUID&&!r)return Tt.randomUUID();r=r||{};const a=r.random??r.rng?.()??Kn();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,Vn(a)}function qn(r){const e=new URL(r),{searchParams:t}=e;return t.delete(ft),t.delete(vt),t.delete(Oe),t.delete(Fe),t.delete(gt),e}function Qn(r,e,t,a){const i=new URL(r),{searchParams:n}=i;return e&&(n.set(vt,e),n.set(ft,t)),n.set(Oe,a),i}function ur(){if(typeof crypto<"u"){const r=new Uint8Array(16);crypto.getRandomValues(r);let e="";for(let t=0;t<r.length;t++)e+=r[t].toString(16).padStart(2,"0");return e=btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),e}return Math.random().toString(36).slice(2)}async function Xn(r,e,t,a){const i=r.withConfig({apiVersion:wt}),n=ur(),s=i.patch(Be).set({secret:n,studioUrl:t,userId:a});return await i.transaction().createIfNotExists({_id:Be,_type:yt,source:e,studioUrl:t,userId:a}).patch(s).commit({tag:xt}),{secret:n}}async function Jn(r,e,t,a){const i=r.withConfig({apiVersion:wt}),n=i.patch(Be).set({secret:null,studioUrl:t,userId:a});await i.transaction().createIfNotExists({_id:Be,_type:yt,source:e,studioUrl:t,userId:a}).patch(n).commit({tag:xt})}function Yn(r){for(var e=[],t=0;t<r.length;){var a=r[t];if(a==="*"||a==="+"||a==="?"){e.push({type:"MODIFIER",index:t,value:r[t++]});continue}if(a==="\\"){e.push({type:"ESCAPED_CHAR",index:t++,value:r[t++]});continue}if(a==="{"){e.push({type:"OPEN",index:t,value:r[t++]});continue}if(a==="}"){e.push({type:"CLOSE",index:t,value:r[t++]});continue}if(a===":"){for(var i="",n=t+1;n<r.length;){var s=r.charCodeAt(n);if(s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||s===95){i+=r[n++];continue}break}if(!i)throw new TypeError("Missing parameter name at ".concat(t));e.push({type:"NAME",index:t,value:i}),t=n;continue}if(a==="("){var c=1,o="",n=t+1;if(r[n]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(n));for(;n<r.length;){if(r[n]==="\\"){o+=r[n++]+r[n++];continue}if(r[n]===")"){if(c--,c===0){n++;break}}else if(r[n]==="("&&(c++,r[n+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(n));o+=r[n++]}if(c)throw new TypeError("Unbalanced pattern at ".concat(t));if(!o)throw new TypeError("Missing pattern at ".concat(t));e.push({type:"PATTERN",index:t,value:o}),t=n;continue}e.push({type:"CHAR",index:t,value:r[t++]})}return e.push({type:"END",index:t,value:""}),e}function Zn(r,e){e===void 0&&(e={});for(var t=Yn(r),a=e.prefixes,i=a===void 0?"./":a,n=e.delimiter,s=n===void 0?"/#?":n,c=[],o=0,u=0,p="",d=function(C){if(u<t.length&&t[u].type===C)return t[u++].value},m=function(C){var j=d(C);if(j!==void 0)return j;var M=t[u],k=M.type,I=M.index;throw new TypeError("Unexpected ".concat(k," at ").concat(I,", expected ").concat(C))},h=function(){for(var C="",j;j=d("CHAR")||d("ESCAPED_CHAR");)C+=j;return C},v=function(C){for(var j=0,M=s;j<M.length;j++){var k=M[j];if(C.indexOf(k)>-1)return!0}return!1},g=function(C){var j=c[c.length-1],M=C||(j&&typeof j=="string"?j:"");if(j&&!M)throw new TypeError('Must have text between two parameters, missing text after "'.concat(j.name,'"'));return!M||v(M)?"[^".concat(Te(s),"]+?"):"(?:(?!".concat(Te(M),")[^").concat(Te(s),"])+?")};u<t.length;){var x=d("CHAR"),w=d("NAME"),P=d("PATTERN");if(w||P){var S=x||"";i.indexOf(S)===-1&&(p+=S,S=""),p&&(c.push(p),p=""),c.push({name:w||o++,prefix:S,suffix:"",pattern:P||g(S),modifier:d("MODIFIER")||""});continue}var y=x||d("ESCAPED_CHAR");if(y){p+=y;continue}p&&(c.push(p),p="");var b=d("OPEN");if(b){var S=h(),_=d("NAME")||"",E=d("PATTERN")||"",R=h();m("CLOSE"),c.push({name:_||(E?o++:""),pattern:_&&!E?g(S):E,prefix:S,suffix:R,modifier:d("MODIFIER")||""});continue}m("END")}return c}function ea(r,e){var t=[],a=pr(r,t,e);return ta(a,t,e)}function ta(r,e,t){t===void 0&&(t={});var a=t.decode,i=a===void 0?function(n){return n}:a;return function(n){var s=r.exec(n);if(!s)return!1;for(var c=s[0],o=s.index,u=Object.create(null),p=function(m){if(s[m]===void 0)return"continue";var h=e[m-1];h.modifier==="*"||h.modifier==="+"?u[h.name]=s[m].split(h.prefix+h.suffix).map(function(v){return i(v,h)}):u[h.name]=i(s[m],h)},d=1;d<s.length;d++)p(d);return{path:c,index:o,params:u}}}function Te(r){return r.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function dr(r){return r&&r.sensitive?"":"i"}function ra(r,e){if(!e)return r;for(var t=/\((?:\?<(.*?)>)?(?!\?)/g,a=0,i=t.exec(r.source);i;)e.push({name:i[1]||a++,prefix:"",suffix:"",modifier:"",pattern:""}),i=t.exec(r.source);return r}function na(r,e,t){var a=r.map(function(i){return pr(i,e,t).source});return new RegExp("(?:".concat(a.join("|"),")"),dr(t))}function aa(r,e,t){return ia(Zn(r,t),e,t)}function ia(r,e,t){t===void 0&&(t={});for(var a=t.strict,i=a===void 0?!1:a,n=t.start,s=n===void 0?!0:n,c=t.end,o=c===void 0?!0:c,u=t.encode,p=u===void 0?function(j){return j}:u,d=t.delimiter,m=d===void 0?"/#?":d,h=t.endsWith,v=h===void 0?"":h,g="[".concat(Te(v),"]|$"),x="[".concat(Te(m),"]"),w=s?"^":"",P=0,S=r;P<S.length;P++){var y=S[P];if(typeof y=="string")w+=Te(p(y));else{var b=Te(p(y.prefix)),_=Te(p(y.suffix));if(y.pattern)if(e&&e.push(y),b||_)if(y.modifier==="+"||y.modifier==="*"){var E=y.modifier==="*"?"?":"";w+="(?:".concat(b,"((?:").concat(y.pattern,")(?:").concat(_).concat(b,"(?:").concat(y.pattern,"))*)").concat(_,")").concat(E)}else w+="(?:".concat(b,"(").concat(y.pattern,")").concat(_,")").concat(y.modifier);else{if(y.modifier==="+"||y.modifier==="*")throw new TypeError('Can not repeat "'.concat(y.name,'" without a prefix and suffix'));w+="(".concat(y.pattern,")").concat(y.modifier)}else w+="(?:".concat(b).concat(_,")").concat(y.modifier)}}if(o)i||(w+="".concat(x,"?")),w+=t.endsWith?"(?=".concat(g,")"):"$";else{var R=r[r.length-1],C=typeof R=="string"?x.indexOf(R[R.length-1])>-1:R===void 0;i||(w+="(?:".concat(x,"(?=").concat(g,"))?")),C||(w+="(?=".concat(x,"|").concat(g,")"))}return new RegExp(w,dr(t))}function pr(r,e,t){return r instanceof RegExp?ra(r,e):Array.isArray(r)?na(r,e,t):aa(r,e,t)}async function sa(r,e,t,a,i=Gt()){const n=r.withConfig({apiVersion:wt});try{const s=new Date(Date.now()+1e3*Mr),c=`drafts.${i}`,o=ur(),u=n.patch(c).set({secret:o,source:e,studioUrl:t,userId:a});return await n.transaction().createOrReplace({_id:c,_type:qt}).patch(u).commit({tag:xt}),{secret:o,expiresAt:s}}finally{try{await n.delete({query:Ir})}catch(s){console.error("Failed to delete expired secrets",s)}}}function oa(r,e){let t=new AbortController,a=[];async function i(s,c){const{result:o,syncTags:u}=await r.fetch(Ur,{},{filterResponse:!1,lastLiveEventId:s,tag:"preview-url-secret.fetch-vercel-bypass-protection-secret"});Array.isArray(u)&&(a=u),c.aborted||e(o)}const n=r.live.events().subscribe({next:s=>{s.type==="message"&&(t.abort(),t=new AbortController,s.tags.some(c=>a.includes(c))&&i(s.id,t.signal))},error:s=>console.error(s)});return i(null,t.signal),()=>{n.unsubscribe(),t.abort()}}const ca=r=>{const e=L.c(3),{comlink:t}=r;let a,i;return e[0]!==t?(a=()=>t.on("visual-editing/features",ua),i=[t],e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]),f.useEffect(a,i),null};var la=f.memo(ca);function ua(){return{features:{optimistic:!0}}}const da=Yt({actions:{},actors:{},guards:{}}).createMachine({id:"Presentation Tool",context:{url:null,error:null,visualEditingOverlaysEnabled:!1},on:{"iframe reload":{actions:Y({url:null}),target:".loading"}},states:{error:{description:"Failed to load, either because of a misconfiguration, a network error, or an unexpected error",tags:["error"]},loading:{on:{"iframe loaded":{target:"loaded"}},tags:["busy"]},loaded:{on:{"toggle visual editing overlays":{actions:Y({visualEditingOverlaysEnabled:({event:r})=>r.enabled})},"iframe refresh":{target:".refreshing"},"iframe reload":{target:".reloading"}},states:{idle:{},refreshing:{on:{"iframe loaded":{target:"idle"}},tags:["busy"]},reloading:{on:{"iframe loaded":{target:"idle"}},tags:["busy"]}},initial:"idle"}},initial:"loading"}),pa=function(r){const e=L.c(14),{comlink:t,children:a}=r;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={},e[0]=i):i=e[0];const n=f.useRef(i);let s,c;e[1]!==t?(s=()=>t?.on("visual-editing/shared-state",()=>({state:n.current})),c=[t],e[1]=t,e[2]=s,e[3]=c):(s=e[2],c=e[3]),f.useEffect(s,c);let o;e[4]!==t?(o=(g,x)=>{n.current[g]=x,t?.post("presentation/shared-state",{key:g,value:x})},e[4]=t,e[5]=o):o=e[5];const u=o;let p;e[6]!==t?(p=g=>{t?.post("presentation/shared-state",{key:g}),delete n.current[g]},e[6]=t,e[7]=p):p=e[7];const d=p;let m;e[8]!==d||e[9]!==u?(m={removeValue:d,setValue:u},e[8]=d,e[9]=u,e[10]=m):m=e[10];const h=m;let v;return e[11]!==a||e[12]!==h?(v=l.jsx(qr.Provider,{value:h,children:a}),e[11]=a,e[12]=h,e[13]=v):v=e[13],v},ma=fe.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,Et=function(r){const e=L.c(15),{children:t,defaultSize:a,id:i,minWidth:n,maxWidth:s,order:c}=r,o=a===void 0?null:a,u=c===void 0?0:c,p=f.useContext(Pt);if(p===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:d,registerElement:m,unregisterElement:h}=p;let v;e[0]!==d||e[1]!==i?(v=d(i),e[0]=d,e[1]=i,e[2]=v):v=e[2];const g=v;let x,w;e[3]!==o||e[4]!==i||e[5]!==s||e[6]!==n||e[7]!==u||e[8]!==m||e[9]!==h?(x=()=>(m(i,{id:i,type:"panel",defaultSize:o,maxWidth:s??null,minWidth:n??0,order:u}),()=>{h(i)}),w=[i,o,u,s,n,m,h],e[3]=o,e[4]=i,e[5]=s,e[6]=n,e[7]=u,e[8]=m,e[9]=h,e[10]=x,e[11]=w):(x=e[10],w=e[11]),f.useLayoutEffect(x,w);let P;return e[12]!==t||e[13]!==g?(P=l.jsx(ma,{style:g,children:t}),e[12]=t,e[13]=g,e[14]=P):P=e[14],P};function mr(r,e){let t;return(...a)=>{clearTimeout(t),t=setTimeout(()=>{r.apply(r,a)},e)}}const hr="presentation/panels",fr=()=>JSON.parse(localStorage.getItem(hr)||"{}"),ha=r=>{localStorage.setItem(hr,JSON.stringify(r))},vr=r=>r.map(e=>[e.id,e.order].join(":")).join(",");function fa(){const r=L.c(1),e=ga,t=va;let a;if(r[0]===Symbol.for("react.memo_cache_sentinel")){const i=mr(t,100);a={get:e,set:t,setDebounced:i},r[0]=a}else a=r[0];return a}function va(r,e){const t=fr(),a=vr(r),i={...t,[a]:e};ha(i)}function ga(r){const e=fr(),t=vr(r);return Array.isArray(e[t])&&e[t].some(wa)?void 0:e[t]}function wa(r){return r===null}function mt(r,e,t){const{maxWidth:a,minWidth:i}=r,n=a==null?100:a/t*100,s=i/t*100;return Math.min(n,Math.max(s,e))}function ya(r,e,t,a,i,n){const{panels:s,widths:c}=i,{widths:o}=n,u=o||c,p=[...u];{const v=r<0?a:t,g=s.findIndex(P=>P.id===v.id),x=u[g],w=mt(v,x+Math.abs(r),e);if(x===w)return u;r=r<0?x-w:w-x}let d=0,m=r<0?t:a,h=s.findIndex(v=>v.id===m.id);for(;;){const v=s[h],g=u[h],x=Math.abs(r)-Math.abs(d),w=mt(v,g-x,e);if(g!==w&&(d+=g-w,p[h]=w,d.toPrecision(10).localeCompare(Math.abs(r).toPrecision(10),void 0,{numeric:!0})>=0))break;if(r<0){if(--h<0)break}else if(++h>=s.length)break}return d===0?u:(m=r<0?a:t,h=s.findIndex(v=>v.id===m.id),p[h]=u[h]+d,p)}function xa(r,e,t){if(r.length===1)return"100";const a=r.findIndex(n=>n.id===e),i=t[a];return i==null?"0":i.toPrecision(10)}function Mt(r,e,t=0,a=null){const i=r.clientX,n=(a||e.getBoundingClientRect()).left;return i-n-t}function st(r){return r.type==="panel"}function It(r){return r.type==="resizer"}function Ut(r){return Array.from(r.values()).sort(({order:e},{order:t})=>e==null&&t==null?0:e==null?-1:t==null?1:e-t)}function $t(r,e,t){const a=e.reduce((s,c)=>s+c,0),i=[...e].map(s=>s/a*100);let n=0;for(let s=0;s<r.length;s++){const c=r[s],o=i[s],u=mt(c,o,t);o!=u&&(n+=o-u,i[s]=u)}if(n.toFixed(3)!=="0.000")for(let s=0;s<r.length;s++){const c=r[s];let{maxWidth:o,minWidth:u}=c;u=u/t*100,o!=null&&(o=o/t*100);const p=Math.min(o??100,Math.max(u,i[s]+n));if(p!==i[s]&&(n-=p-i[s],i[s]=p,Math.abs(n).toFixed(3)==="0.000"))break}return i}function ba(r){let e=r.length,t=100;const a=r.map(n=>n.defaultSize?(t-=n.defaultSize,e-=1,n.defaultSize):null),i=t/e;return a.map(n=>n===null?i:n)}const Pa=fe.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,Sa=function(r){const e=L.c(46),{children:t}=r,a=f.useRef(null);let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new Map,e[0]=i):i=e[0];const[n,s]=f.useState(i);let c;e[1]!==n?(c=Ut(n).filter(st),e[1]=n,e[2]=c):c=e[2];const o=c;let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u=[],e[3]=u):u=e[3];const[p,d]=f.useState(u),[m,h]=f.useState(null);let v;e[4]!==n||e[5]!==o||e[6]!==p?(v={elements:n,panels:o,widths:p},e[4]=n,e[5]=o,e[6]=p,e[7]=v):v=e[7];const g=f.useRef(v);let x;e[8]!==m||e[9]!==o||e[10]!==p?(x=O=>({flexGrow:xa(o,O,p),pointerEvents:m===null?void 0:"none"}),e[8]=m,e[9]=o,e[10]=p,e[11]=x):x=e[11];const w=x;let P;e[12]===Symbol.for("react.memo_cache_sentinel")?(P=(O,H)=>{s(N=>{if(N.has(O))return N;const G=new Map(N);return G.set(O,H),G})},e[12]=P):P=e[12];const S=P;let y;e[13]===Symbol.for("react.memo_cache_sentinel")?(y=O=>{s(H=>{if(!H.has(O))return H;const N=new Map(H);return N.delete(O),N})},e[13]=y):y=e[13];const b=y;let _;e[14]===Symbol.for("react.memo_cache_sentinel")?(_={containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]},e[14]=_):_=e[14];const E=f.useRef(_);let R;e[15]!==n?(R=(O,H)=>{const N=Ut(n),G=N.findIndex(T=>T.id===O),ne=n.get(O);if(!ne||!It(ne))return;const se=ne.el.current;se&&(E.current={resizerIndex:G,panelBefore:N.reduce((T,V,z)=>st(V)&&z<G?V:T,null),panelAfter:N.reduce((T,V,z)=>T===null&&st(V)&&z>G?V:T,null),containerWidth:window.innerWidth,startX:H.pageX,dragOffset:Mt(H,se),resizerRect:se.getBoundingClientRect(),widths:g.current.widths},h(O))},e[15]=n,e[16]=R):R=e[16];const C=R;let j;e[17]===Symbol.for("react.memo_cache_sentinel")?(j=()=>{h(null)},e[17]=j):j=e[17];const M=j;let k;e[18]!==n?(k=(O,H)=>{H.preventDefault(),H.stopPropagation();const{containerWidth:N,dragOffset:G,panelBefore:ne,panelAfter:se,resizerRect:T}=E.current;if(ne==null||se==null)return;const V=n.get(O);if(!V||!It(V))return;const z=V.el.current;if(!z)return;const de=Mt(H,z,G,T);if(de===0)return;const{widths:_e}=g.current,ye=a.current.getBoundingClientRect(),xe=de/ye.width*100,me=ya(xe,N,ne,se,g.current,E.current);_e.some((be,Pe)=>be!==me[Pe])&&d(me)},e[18]=n,e[19]=k):k=e[19];const I=k;let $,U;e[20]!==n||e[21]!==o||e[22]!==p?($=()=>{g.current.elements=n,g.current.panels=o,g.current.widths=p},U=[n,o,p],e[20]=n,e[21]=o,e[22]=p,e[23]=$,e[24]=U):($=e[23],U=e[24]),f.useLayoutEffect($,U);const B=fa();let q,K;e[25]!==o||e[26]!==B?(q=()=>{const{widths:O}=g.current;if(O.length===o.length)return;const H=B.get(o);if(H){const G=$t(o,H,window.innerWidth);d(G);return}const N=ba(o);d(N)},K=[B,o],e[25]=o,e[26]=B,e[27]=q,e[28]=K):(q=e[27],K=e[28]),f.useLayoutEffect(q,K);let F,Q;e[29]!==o||e[30]!==B||e[31]!==p?(F=()=>{p.length&&B.setDebounced(o,p)},Q=[B,o,p],e[29]=o,e[30]=B,e[31]=p,e[32]=F,e[33]=Q):(F=e[32],Q=e[33]),f.useEffect(F,Q);let J,te;e[34]===Symbol.for("react.memo_cache_sentinel")?(J=()=>{const O=new ResizeObserver(()=>{const{panels:H,widths:N}=g.current,G=$t(H,N,window.innerWidth);N.some((ne,se)=>ne!==G[se])&&d(G)});return O.observe(a.current),()=>{O.disconnect()}},te=[],e[34]=J,e[35]=te):(J=e[34],te=e[35]),f.useLayoutEffect(J,te);let ee;e[36]!==m||e[37]!==I||e[38]!==w||e[39]!==C?(ee={activeResizer:m,drag:I,getPanelStyle:w,registerElement:S,startDragging:C,stopDragging:M,unregisterElement:b},e[36]=m,e[37]=I,e[38]=w,e[39]=C,e[40]=ee):ee=e[40];const oe=ee;let ce;e[41]!==t?(ce=l.jsx(Pa,{ref:a,children:t}),e[41]=t,e[42]=ce):ce=e[42];let re;return e[43]!==oe||e[44]!==ce?(re=l.jsx(Pt.Provider,{value:oe,children:ce}),e[43]=oe,e[44]=ce,e[45]=re):re=e[45],re};function Rt(r){const e=L.c(37);let t,a,i,n,s;e[0]!==r?({children:t,message:a,onRetry:n,onContinueAnyway:i,...s}=r,e[0]=r,e[1]=t,e[2]=a,e[3]=i,e[4]=n,e[5]=s):(t=e[1],a=e[2],i=e[3],n=e[4],s=e[5]);const{t:c}=ge(we);let o;e[6]!==c?(o=c("error-card.retry-button.text"),e[6]=c,e[7]=o):o=e[7];let u;e[8]!==n||e[9]!==o?(u=l.jsx(Ee,{mode:"ghost",onClick:n,text:o}),e[8]=n,e[9]=o,e[10]=u):u=e[10];const p=u;let d;e[11]!==c?(d=c("error-card.continue-button.text"),e[11]=c,e[12]=d):d=e[12];let m;e[13]!==i||e[14]!==d?(m=l.jsx(Ee,{mode:"ghost",tone:"critical",onClick:i,text:d}),e[13]=i,e[14]=d,e[15]=m):m=e[15];const h=m;let v;e[16]!==c?(v=c("error-card.title"),e[16]=c,e[17]=v):v=e[17];let g;e[18]!==v?(g=l.jsx(Z,{size:1,weight:"semibold",children:v}),e[18]=v,e[19]=g):g=e[19];let x;e[20]!==a?(x=l.jsx(Z,{muted:!0,size:1,children:a}),e[20]=a,e[21]=x):x=e[21];let w;e[22]!==g||e[23]!==x?(w=l.jsxs(Ie,{space:3,children:[g,x]}),e[22]=g,e[23]=x,e[24]=w):w=e[24];let P;e[25]!==h||e[26]!==i||e[27]!==n||e[28]!==p?(P=n&&i?l.jsxs(nn,{space:2,children:[p,h]}):n?l.jsx(he,{children:p}):i?l.jsx(he,{children:h}):null,e[25]=h,e[26]=i,e[27]=n,e[28]=p,e[29]=P):P=e[29];let S;e[30]!==t||e[31]!==w||e[32]!==P?(S=l.jsx(ie,{align:"center",height:"fill",justify:"center",children:l.jsx(an,{padding:4,sizing:"border",width:0,children:l.jsxs(Ie,{space:4,children:[w,t,P]})})}),e[30]=t,e[31]=w,e[32]=P,e[33]=S):S=e[33];let y;return e[34]!==s||e[35]!==S?(y=l.jsx(ue,{height:"fill",...s,children:S}),e[34]=s,e[35]=S,e[36]=y):y=e[36],y}const gr=f.forwardRef(function(r,e){const t=L.c(17);let a,i,n,s,c;if(t[0]!==r){const{childId:d,childType:m,childPayload:h,childParameters:v,searchParams:g,...x}=r;a=d,n=m,i=v,c=g,s=x,t[0]=r,t[1]=a,t[2]=i,t[3]=n,t[4]=s,t[5]=c}else a=t[1],i=t[2],n=t[3],s=t[4],c=t[5];let o;t[6]!==i||t[7]!==c?(o=Object.entries({...c,...i}),t[6]=i,t[7]=c,t[8]=o):o=t[8];let u;t[9]!==a||t[10]!==n||t[11]!==o?(u={id:a,type:n,_searchParams:o},t[9]=a,t[10]=n,t[11]=o,t[12]=u):u=t[12];let p;return t[13]!==e||t[14]!==s||t[15]!==u?(p=l.jsx(jt,{...s,ref:e,state:u}),t[13]=e,t[14]=s,t[15]=u,t[16]=p):p=t[16],p}),_a=f.forwardRef(function(r,e){const t=L.c(22);let a,i,n,s,c,o;t[0]!==r?({documentId:a,documentType:i,parentRefPath:n,template:o,searchParams:c,...s}=r,t[0]=r,t[1]=a,t[2]=i,t[3]=n,t[4]=s,t[5]=c,t[6]=o):(a=t[1],i=t[2],n=t[3],s=t[4],c=t[5],o=t[6]);const u=o?.params;let p;t[7]!==n?(p=sn(n),t[7]=n,t[8]=p):p=t[8];let d;t[9]!==o?(d=o&&{template:o?.id},t[9]=o,t[10]=d):d=t[10];let m;t[11]!==p||t[12]!==d?(m={parentRefPath:p,...d},t[11]=p,t[12]=d,t[13]=m):m=t[13];let h;return t[14]!==a||t[15]!==i||t[16]!==e||t[17]!==s||t[18]!==c||t[19]!==u||t[20]!==m?(h=l.jsx(gr,{...s,ref:e,childId:a,childType:i,childPayload:u,childParameters:m,searchParams:c}),t[14]=a,t[15]=i,t[16]=e,t[17]=s,t[18]=c,t[19]=u,t[20]=m,t[21]=h):h=t[21],h});function ja(r={}){const e=Object.entries(r).map(([t,a])=>`${t}=${a}`).join("&");return e.length?`?${e}`:""}function Ea(r){const e=["comment","inspect","instruction","pathKey","rev","since","template","view"],t=Object.entries(r).filter(([a])=>e.includes(a)).reduce((a,[i,n])=>n==null?a:{...a,[i]:n},{});return ja(t)}const Ra=f.forwardRef(function(r,e){const t=L.c(9);let a,i;t[0]!==r?({searchParams:i,...a}=r,t[0]=r,t[1]=a,t[2]=i):(a=t[1],i=t[2]);let n;t[3]!==i?(n={type:void 0,_searchParams:Object.entries(i)},t[3]=i,t[4]=n):n=t[4];let s;return t[5]!==e||t[6]!==a||t[7]!==n?(s=l.jsx(jt,{...a,ref:e,state:n,title:void 0}),t[5]=e,t[6]=a,t[7]=n,t[8]=s):s=t[8],s});function wr(r){const e=L.c(28),{children:t,onEditReference:a,onStructureParams:i,structureParams:n,searchParams:s,refs:c}=r,{state:o,resolvePathFromState:u}=Ke();let p;e[0]!==o._searchParams?(p=Object.fromEntries(o._searchParams||[]),e[0]=o._searchParams,e[1]=p):p=e[1];const d=tr(p);let m;e[2]!==u||e[3]!==d||e[4]!==o?(m=R=>{const C=u(o),j=Ea({...d,...R});return`${C}${j}`},e[2]=u,e[3]=d,e[4]=o,e[5]=m):m=e[5];const h=m;let v;e[6]===Symbol.for("react.memo_cache_sentinel")?(v={},e[6]=v):v=e[6];const g=n;let x;e[7]===Symbol.for("react.memo_cache_sentinel")?(x=[],e[7]=x):x=e[7];let w;e[8]!==c||e[9]!==s?(w=f.forwardRef(function(R,C){const{childId:j,...M}=R,k=c?.find(I=>I._id===j||rt(I._id)===j);return k?l.jsx(gr,{...M,ref:C,childId:j,childType:k._type,searchParams:s}):(console.warn(`ChildLink: No document found for childId "${j}"`),null)}),e[8]=c,e[9]=s,e[10]=w):w=e[10];let P;e[11]!==s?(P=f.forwardRef(function(R,C){return l.jsx(Ra,{...R,ref:C,searchParams:s})}),e[11]=s,e[12]=P):P=e[12];let S;e[13]!==s?(S=f.forwardRef(function(R,C){return l.jsx(_a,{...R,ref:C,searchParams:s})}),e[13]=s,e[14]=S):S=e[14];let y;e[15]!==a?(y=R=>{const{id:C,template:j,type:M,parentRefPath:k,version:I}=R;a({state:{id:C,type:M},params:{template:j.id,parentRefPath:Rn(k),version:I}})},e[15]=a,e[16]=y):y=e[16];let b;e[17]!==h||e[18]!==i||e[19]!==g||e[20]!==w||e[21]!==P||e[22]!==S||e[23]!==y?(b={index:0,groupIndex:0,siblingIndex:0,payload:v,params:g,hasGroupSiblings:!1,groupLength:1,routerPanesState:x,ChildLink:w,BackLink:P,ReferenceChildLink:S,ParameterizedLink:$a,closeCurrentAndAfter:Ua,handleEditReference:y,replaceCurrent:Ia,closeCurrent:Ma,duplicateCurrent:Ta,setView:Aa,setParams:i,setPayload:ka,navigateIntent:Ca,createPathWithParams:h},e[17]=h,e[18]=i,e[19]=g,e[20]=w,e[21]=P,e[22]=S,e[23]=y,e[24]=b):b=e[24];const _=b;let E;return e[25]!==t||e[26]!==_?(E=l.jsx(En.Provider,{value:_,children:t}),e[25]=t,e[26]=_,e[27]=E):E=e[27],E}function Ca(r,e,t){console.warn("navigateIntent",r,e,t)}function ka(r){console.warn("setPayload",r)}function Aa(r){console.warn("setView",r)}function Ta(r){console.warn("duplicateCurrent",r)}function Ma(){console.warn("closeCurrent")}function Ia(r){console.warn("replaceCurrent",r)}function Ua(){console.warn("closeCurrentAndAfter")}function $a(){throw new Error("ParameterizedLink not implemented")}const La=fe(lr)`
  height: 100%;
`,Da=fe(ie)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,Oa=fe(Ye)`
  white-space: pre-wrap;
`;function za(r){const e=L.c(34),{mainDocumentState:t,onEditReference:a,onStructureParams:i,searchParams:n,refs:s}=r,{t:c}=ge(we),{devMode:o}=St();let u;if(e[0]!==t?.document?._id||e[1]!==s){let R;e[3]!==t?.document?._id?(R=C=>rt(C._id)!==t?.document?._id,e[3]=t?.document?._id,e[4]=R):R=e[4],u=s.filter(R).map(Na),e[0]=t?.document?._id,e[1]=s,e[2]=u}else u=e[2];const p=u;let d;e[5]!==p?(d={filter:"_id in $ids",params:{ids:p}},e[5]=p,e[6]=d):d=e[6];let m;e[7]!==c?(m=c("document-list-pane.document-list.title"),e[7]=c,e[8]=m):m=e[8];let h;e[9]!==d||e[10]!==m?(h={id:"$root",options:d,schemaTypeName:"",title:m,type:"documentList"},e[9]=d,e[10]=m,e[11]=h):h=e[11];const v=h,[g,x]=f.useState(null);let w;e[12]===Symbol.for("react.memo_cache_sentinel")?(w=()=>x(null),e[12]=w):w=e[12];const P=w,[S]=f.useState(Wa);let y;e[13]===Symbol.for("react.memo_cache_sentinel")?(y=()=>x(null),e[13]=y):y=e[13];let b;if(e[14]!==s?(b=[s],e[14]=s,e[15]=b):b=e[15],f.useEffect(y,b),g){let R;e[16]!==c?(R=c("document-list-pane.error.text"),e[16]=c,e[17]=R):R=e[17];let C;e[18]!==o||e[19]!==g||e[20]!==c?(C=o&&l.jsx(ue,{overflow:"auto",padding:3,radius:2,tone:"critical",children:l.jsxs(Ie,{space:3,children:[l.jsx(Je,{muted:!0,size:0,children:c("presentation-error.label")}),l.jsx(Oa,{size:1,children:g.error.message})]})}),e[18]=o,e[19]=g,e[20]=c,e[21]=C):C=e[21];let j;return e[22]!==R||e[23]!==C?(j=l.jsx(Rt,{flex:1,message:R,onRetry:P,children:C}),e[22]=R,e[23]=C,e[24]=j):j=e[24],j}let _;e[25]!==v?(_=l.jsx(Da,{direction:"column",flex:1,children:l.jsx(Un,{index:0,itemId:"$root",pane:v,paneKey:"$root"})}),e[25]=v,e[26]=_):_=e[26];let E;return e[27]!==a||e[28]!==i||e[29]!==s||e[30]!==n||e[31]!==S||e[32]!==_?(E=l.jsx(cr,{onCatch:x,children:l.jsx(La,{children:l.jsx(or,{children:l.jsx(wr,{onEditReference:a,onStructureParams:i,structureParams:S,searchParams:n,refs:s,children:_})})})}),e[27]=a,e[28]=i,e[29]=s,e[30]=n,e[31]=S,e[32]=_,e[33]=E):E=e[33],E}function Wa(){return{}}function Na(r){return rt(r._id)}const Fa=fe(Ye)`
  white-space: pre-wrap;
`;function Va(r){const e=L.c(40),{documentId:t,documentType:a,onFocusPath:i,onEditReference:n,onStructureParams:s,searchParams:c,structureParams:o}=r,{template:u,templateParams:p}=o,{t:d}=ge(we),{devMode:m}=St();let h;e[0]!==p?(h=jn(p),e[0]=p,e[1]=h):h=e[1];let v;e[2]!==t||e[3]!==a||e[4]!==h||e[5]!==u?(v={id:t,type:a,template:u,templateParameters:h},e[2]=t,e[3]=a,e[4]=h,e[5]=u,e[6]=v):v=e[6];let g;e[7]!==t||e[8]!==v?(g={id:t,options:v,title:"",type:"document"},e[7]=t,e[8]=v,e[9]=g):g=e[9];const x=g;let w;e[10]!==t||e[11]!==a||e[12]!==i?(w=I=>i({id:t,type:a,path:ar.toString(I)}),e[10]=t,e[11]=a,e[12]=i,e[13]=w):w=e[13];const P=w,[S,y]=f.useState(null);let b;e[14]===Symbol.for("react.memo_cache_sentinel")?(b=()=>y(null),e[14]=b):b=e[14];const _=b;let E;e[15]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{y(null)},e[15]=E):E=e[15];let R;if(e[16]!==t||e[17]!==a||e[18]!==o?(R=[t,a,o],e[16]=t,e[17]=a,e[18]=o,e[19]=R):R=e[19],f.useEffect(E,R),S){let I;e[20]!==d?(I=d("document-pane.error.text"),e[20]=d,e[21]=I):I=e[21];let $;e[22]!==m||e[23]!==S||e[24]!==d?($=m&&l.jsx(ue,{overflow:"auto",padding:3,radius:2,tone:"critical",children:l.jsxs(Ie,{space:3,children:[l.jsx(Je,{muted:!0,size:0,children:d("presentation-error.label")}),l.jsx(Fa,{size:1,children:S.error.message})]})}),e[22]=m,e[23]=S,e[24]=d,e[25]=$):$=e[25];let U;return e[26]!==I||e[27]!==$?(U=l.jsx(Rt,{flex:1,message:I,onRetry:_,children:$}),e[26]=I,e[27]=$,e[28]=U):U=e[28],U}let C;e[29]===Symbol.for("react.memo_cache_sentinel")?(C={height:"100%"},e[29]=C):C=e[29];let j;e[30]===Symbol.for("react.memo_cache_sentinel")?(j=l.jsx(Qt,{}),e[30]=j):j=e[30];let M;e[31]!==P||e[32]!==x?(M=l.jsx(f.Suspense,{fallback:j,children:l.jsx(Cn,{paneKey:"document",index:1,itemId:"document",pane:x,onFocusPath:P})}),e[31]=P,e[32]=x,e[33]=M):M=e[33];let k;return e[34]!==n||e[35]!==s||e[36]!==c||e[37]!==o||e[38]!==M?(k=l.jsx(cr,{onCatch:y,children:l.jsx(lr,{style:C,children:l.jsx(wr,{searchParams:c,onEditReference:n,onStructureParams:s,structureParams:o,children:M})})}),e[34]=n,e[35]=s,e[36]=c,e[37]=o,e[38]=M,e[39]=k):k=e[39],k}function Ba(r){const e=L.c(8),{documentId:t,documentType:a,onFocusPath:i,onEditReference:n,onStructureParams:s,searchParams:c,structureParams:o}=r;let u;return e[0]!==t||e[1]!==a||e[2]!==n||e[3]!==i||e[4]!==s||e[5]!==c||e[6]!==o?(u=l.jsx(or,{children:l.jsx(Va,{documentId:t,documentType:a,onEditReference:n,onFocusPath:i,onStructureParams:s,searchParams:c,structureParams:o})}),e[0]=t,e[1]=a,e[2]=n,e[3]=i,e[4]=s,e[5]=c,e[6]=o,e[7]=u):u=e[7],u}function Ka(r,e){const t=L.c(7),a=_n();let i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i={},t[0]=i):i=t[0];const[n,s]=f.useState(i),{perspectiveStack:c}=bt();let o,u;return t[1]!==r||t[2]!==a||t[3]!==c||t[4]!==e?(o=()=>{if(!e)return;const p=kn(a,e,r,c).subscribe(d=>{s(d)});return()=>{p?.unsubscribe()}},u=[a,e,r,c],t[1]=r,t[2]=a,t[3]=c,t[4]=e,t[5]=o,t[6]=u):(o=t[5],u=t[6]),f.useEffect(o,u),n}function Ha(r){const e=L.c(40),{documentId:t,documentType:a,mainDocumentState:i,onEditReference:n,onFocusPath:s,onStructureParams:c,refs:o,searchParams:u,structureParams:p}=r,{t:d}=ge(we),m=wn();let h;e[0]!==i?.document?._id||e[1]!==i?.document?._type||e[2]!==u?(h=E=>l.jsx(jt,{...E,state:{id:i?.document?._id,type:i?.document?._type,_searchParams:Object.entries(u)}}),e[0]=i?.document?._id,e[1]=i?.document?._type,e[2]=u,e[3]=h):h=e[3];const v=h;let g;e[4]!==i?.document?._type||e[5]!==m?(g=m.get(i?.document?._type||"shoe"),e[4]=i?.document?._type,e[5]=m,e[6]=g):g=e[6];const x=g,w=Ka(i?.document?._id||"",x);let P;e:{if(!i?.document){P=null;break e}let E;e[7]!==i.document||e[8]!==w.snapshot?(E=yn({snapshot:w.snapshot,fallback:i.document}),e[7]=i.document,e[8]=w.snapshot,e[9]=E):E=e[9];let R;e[10]!==d?(R=d("main-document.label"),e[10]=d,e[11]=R):R=e[11];let C;e[12]!==R?(C=l.jsx(ue,{padding:1,radius:2,shadow:1,children:l.jsx(Z,{muted:!0,size:0,weight:"medium",children:R})}),e[12]=R,e[13]=C):C=e[13];let j;e[14]!==x||e[15]!==E||e[16]!==C?(j=l.jsx(xn,{...E,schemaType:x,status:C}),e[14]=x,e[15]=E,e[16]=C,e[17]=j):j=e[17],P=j}const S=P;if(t&&a){let E;return e[18]!==t||e[19]!==a||e[20]!==n||e[21]!==s||e[22]!==c||e[23]!==u||e[24]!==p?(E=l.jsx(Ba,{documentId:t,documentType:a,onEditReference:n,onFocusPath:s,onStructureParams:c,searchParams:u,structureParams:p}),e[18]=t,e[19]=a,e[20]=n,e[21]=s,e[22]=c,e[23]=u,e[24]=p,e[25]=E):E=e[25],E}let y;e[26]!==v||e[27]!==i||e[28]!==S||e[29]!==d?(y=i&&l.jsx(ue,{padding:3,tone:i.document?"inherit":"caution",children:i.document?l.jsx(bn,{__unstable_focusRing:!0,as:v,"data-as":"a",radius:2,sizing:"border",tone:"inherit",children:S}):l.jsx(ue,{padding:2,radius:2,tone:"inherit",children:l.jsxs(ie,{gap:3,children:[l.jsx(he,{flex:"none",children:l.jsx(Z,{size:1,children:l.jsx(Pn,{})})}),l.jsx(he,{flex:1,children:l.jsx(Z,{size:1,children:l.jsx(_t,{t:d,i18nKey:"main-document.missing.text",components:{Code:"code"},values:{path:i.path}})})})]})})}),e[26]=v,e[27]=i,e[28]=S,e[29]=d,e[30]=y):y=e[30];let b;e[31]!==i||e[32]!==n||e[33]!==c||e[34]!==o||e[35]!==u?(b=l.jsx(za,{mainDocumentState:i,onEditReference:n,onStructureParams:c,searchParams:u,refs:o}),e[31]=i,e[32]=n,e[33]=c,e[34]=o,e[35]=u,e[36]=b):b=e[36];let _;return e[37]!==y||e[38]!==b?(_=l.jsxs(ie,{direction:"column",flex:1,height:"fill",children:[y,b]}),e[37]=y,e[38]=b,e[39]=_):_=e[39],_}function Ga(r){const e=L.c(2);let t;e[0]!==r?(t=()=>r||Gn(),e[0]=r,e[1]=t):t=e[1];const[a]=f.useState(t);return a}const qa=fe.div`
  position: relative;
`,Qa=fe.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:r})=>r?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:r})=>!r&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,yr=function(r){const e=L.c(27),{id:t,order:a,disabled:i}=r,n=i===void 0?!1:i,s=f.useRef(null),c=f.useContext(Pt);if(c===null)throw Error("Panel components must be rendered within a PanelGroup container");const o=Ga(t),{activeResizer:u,drag:p,startDragging:d,stopDragging:m,registerElement:h,unregisterElement:v}=c,g=u===o;if(c===null)throw Error("Panel components must be rendered within a PanelGroup container");let x;e[0]!==o||e[1]!==d?(x=$=>{d(o,$.nativeEvent)},e[0]=o,e[1]=d,e[2]=x):x=e[2];const w=x;let P;e[3]!==p||e[4]!==o?(P=$=>{p(o,$)},e[3]=p,e[4]=o,e[5]=P):P=e[5];const S=P;let y;e[6]!==m?(y=()=>{s.current.blur(),m()},e[6]=m,e[7]=y):y=e[7];const b=y;let _,E;e[8]!==n||e[9]!==g||e[10]!==S||e[11]!==b?(_=()=>{if(!g||n)return;const $=(function(){const U=document.body.style,B=document.documentElement.style,{cursor:q}=B,{userSelect:K}=U;return B.cursor="ew-resize",U.userSelect="none",()=>{q?B.cursor=q:B.removeProperty("cursor"),K?U.userSelect=K:U.removeProperty("user-select")}})();return window.addEventListener("mousemove",S),window.addEventListener("mouseup",b),window.addEventListener("contextmenu",b),()=>{$(),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",b),window.removeEventListener("contextmenu",b)}},E=[n,g,S,b],e[8]=n,e[9]=g,e[10]=S,e[11]=b,e[12]=_,e[13]=E):(_=e[12],E=e[13]),f.useEffect(_,E);let R,C;e[14]!==o||e[15]!==a||e[16]!==h||e[17]!==v?(R=()=>(h(o,{id:o,order:a,type:"resizer",el:s}),()=>{v(o)}),C=[o,a,h,v],e[14]=o,e[15]=a,e[16]=h,e[17]=v,e[18]=R,e[19]=C):(R=e[18],C=e[19]),f.useLayoutEffect(R,C);let j,M;e[20]===Symbol.for("react.memo_cache_sentinel")?(M=l.jsx("span",{}),j=l.jsx("span",{}),e[20]=j,e[21]=M):(j=e[20],M=e[21]);let k;e[22]!==n?(k=l.jsxs(Qa,{$disabled:n,children:[M,j]}),e[22]=n,e[23]=k):k=e[23];let I;return e[24]!==w||e[25]!==k?(I=l.jsx(qa,{onMouseDown:w,ref:s,children:k}),e[24]=w,e[25]=k,e[26]=I):I=e[26],I},Xa=r=>{const e=L.c(8),{documentId:t,setDisplayedDocument:a,getCommentIntent:i}=r;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=l.jsx(yr,{order:4}),e[0]=n):n=e[0];let s;e[1]!==i||e[2]!==r.children?(s=l.jsx(Zr,{getIntent:i,children:r.children}),e[1]=i,e[2]=r.children,e[3]=s):s=e[3];let c;return e[4]!==t||e[5]!==a||e[6]!==s?(c=l.jsxs(l.Fragment,{children:[n,l.jsx(Et,{id:"content",minWidth:325,order:5,children:l.jsx($n,{documentId:t,setDisplayedDocument:a,children:s})})]}),e[4]=t,e[5]=a,e[6]=s,e[7]=c):c=e[7],c},Ja=r=>{const e=L.c(15),{documentId:t,documentsOnPage:a,documentType:i,getCommentIntent:n,mainDocumentState:s,onEditReference:c,onFocusPath:o,onStructureParams:u,searchParams:p,setDisplayedDocument:d,structureParams:m}=r;let h;e[0]!==t||e[1]!==i||e[2]!==a||e[3]!==s||e[4]!==c||e[5]!==o||e[6]!==u||e[7]!==p||e[8]!==m?(h=l.jsx(Ha,{documentId:t,documentType:i,mainDocumentState:s,onEditReference:c,onFocusPath:o,onStructureParams:u,refs:a,searchParams:p,structureParams:m}),e[0]=t,e[1]=i,e[2]=a,e[3]=s,e[4]=c,e[5]=o,e[6]=u,e[7]=p,e[8]=m,e[9]=h):h=e[9];let v;return e[10]!==t||e[11]!==n||e[12]!==d||e[13]!==h?(v=l.jsx(Xa,{documentId:t,getCommentIntent:n,setDisplayedDocument:d,children:h}),e[10]=t,e[11]=n,e[12]=d,e[13]=h,e[14]=v):v=e[14],v},Ya=function(r){const e=L.c(5),{children:t,navigate:a}=r;let i;e[0]!==a?(i=(c,o)=>{if(c||o){const u={};c&&(u.params={preview:c}),o&&(u.state=o),a(u)}},e[0]=a,e[1]=i):i=e[1];const n=i;let s;return e[2]!==t||e[3]!==n?(s=l.jsx(Hr.Provider,{value:n,children:t}),e[2]=t,e[3]=n,e[4]=s):s=e[4],s};function Za(r,e){const t=L.c(9);let a;t[0]!==e||t[1]!==r?(a=()=>JSON.parse(localStorage.getItem(r)??JSON.stringify(e)),t[0]=e,t[1]=r,t[2]=a):a=t[2];const[i,n]=f.useState(a);let s,c;t[3]!==r||t[4]!==i?(s=()=>{localStorage.setItem(r,JSON.stringify(i))},c=[r,i],t[3]=r,t[4]=i,t[5]=s,t[6]=c):(s=t[5],c=t[6]),f.useEffect(s,c);let o;return t[7]!==i?(o=[i,n],t[7]=i,t[8]=o):o=t[8],o}function ei(r){const e=L.c(11),{unstable_navigator:t}=r,a=!!t?.component,[i,n]=Za("presentation/navigator",a),s=a?i:!1;let c;e:{if(!a){c=void 0;break e}let h;e[0]!==n?(h=()=>n(ti),e[0]=n,e[1]=h):h=e[1],c=h}const o=c;let u;e[2]!==s||e[3]!==t?(u=function(){return l.jsx(l.Fragment,{children:s&&l.jsx(ni,{...t})})},e[2]=s,e[3]=t,e[4]=u):u=e[4];const p=u;let d;e[5]!==s||e[6]!==o?(d={navigatorEnabled:s,toggleNavigator:o},e[5]=s,e[6]=o,e[7]=d):d=e[7];let m;return e[8]!==p||e[9]!==d?(m=[d,p],e[8]=p,e[9]=d,e[10]=m):m=e[10],m}function ti(r){return!r}function ri(r){const e=L.c(11),{minWidth:t,maxWidth:a,component:i}=r,n=t!=null&&a!=null&&t===a;let s;e[0]!==i?(s=l.jsx(i,{}),e[0]=i,e[1]=s):s=e[1];let c;e[2]!==a||e[3]!==t||e[4]!==s?(c=l.jsx(Et,{id:"navigator",minWidth:t,maxWidth:a,order:1,children:s}),e[2]=a,e[3]=t,e[4]=s,e[5]=c):c=e[5];let o;e[6]!==n?(o=l.jsx(yr,{order:2,disabled:n}),e[6]=n,e[7]=o):o=e[7];let u;return e[8]!==c||e[9]!==o?(u=l.jsxs(l.Fragment,{children:[c,o]}),e[8]=c,e[9]=o,e[10]=u):u=e[10],u}const ni=f.memo(ri),ai=function(r){const e=L.c(3),{children:t,params:a}=r,i=a;let n;return e[0]!==t||e[1]!==i?(n=l.jsx(Gr.Provider,{value:i,children:t}),e[0]=t,e[1]=i,e[2]=n):n=e[2],n},ii=function(r){const e=L.c(10),{children:t,devMode:a,name:i,navigate:n,params:s,searchParams:c,structureParams:o}=r;let u;e[0]!==a||e[1]!==i||e[2]!==n||e[3]!==s||e[4]!==c||e[5]!==o?(u={devMode:a,name:i,navigate:n,params:s,searchParams:c,structureParams:o},e[0]=a,e[1]=i,e[2]=n,e[3]=s,e[4]=c,e[5]=o,e[6]=u):u=e[6];const p=u;let d;return e[7]!==t||e[8]!==p?(d=l.jsx(Kr.Provider,{value:p,children:t}),e[7]=t,e[8]=p,e[9]=d):d=e[9],d};function Ct(r){const e=X(r,si);if(!Array.isArray(e))throw new TypeError("allowPatterns must be an array");return e}function si(r){return r.context.allowOrigins}function ze(r){return Array.isArray(r)?r.join(","):r}function xr(){const r=L.c(2),e=f.useId();let t;return r[0]!==e?(t=e.startsWith(":")?e.replace(/^:(.+):$/,"«$1»"):e,r[0]=e,r[1]=t):t=r[1],t}const oi=f.forwardRef(function(r,e){const t=L.c(19),{animate:a,initial:i,onLoad:n,preventClick:s,src:c,variants:o,style:u}=r,p=f.useRef(null);let d;t[0]===Symbol.for("react.memo_cache_sentinel")?(d=()=>p.current,t[0]=d):d=t[0],f.useImperativeHandle(e,d);let m,h;t[1]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{if(!p.current)return;const y=p.current,b=function(){y===document.activeElement&&y.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))};return window.addEventListener("blur",b),()=>{window.removeEventListener("blur",b)}},h=[],t[1]=m,t[2]=h):(m=t[1],h=t[2]),f.useEffect(m,h);const v=xr();let g;t[3]!==u||t[4]!==v?(g={...u,viewTransitionName:v},t[3]=u,t[4]=v,t[5]=g):g=t[5];let x;t[6]!==a||t[7]!==i||t[8]!==n||t[9]!==c||t[10]!==g||t[11]!==o?(x=l.jsx(ci,{style:g,animate:a,initial:i,onLoad:n,ref:p,src:c,variants:o}),t[6]=a,t[7]=i,t[8]=n,t[9]=c,t[10]=g,t[11]=o,t[12]=x):x=t[12];let w;t[13]!==s?(w=s&&l.jsx(li,{}),t[13]=s,t[14]=w):w=t[14];let P;t[15]===Symbol.for("react.memo_cache_sentinel")?(P=l.jsx(ui,{}),t[15]=P):P=t[15];let S;return t[16]!==x||t[17]!==w?(S=l.jsxs(l.Fragment,{children:[x,w,P]}),t[16]=x,t[17]=w,t[18]=S):S=t[18],S}),ci=He.create(fe.iframe`
  box-shadow: 0 0 0 1px var(--card-border-color);
  border: 0;
  max-height: 100%;
  width: 100%;
  view-transition-class: presentation-tool-iframe;
`),li=fe(he)`
  position: absolute;
  inset: 0;
  background: transparent;
`,ui=on`
html:active-view-transition-type(sanity-iframe-viewport) {
  view-transition-name: none;
  &::view-transition {
    pointer-events: none;
  }
  /* &::view-transition-old(root) {
    display: none;
  }
  &::view-transition-new(root) {
    animation: none;
  } */
}
`;function di(r){const e=L.c(16),{openPopup:t,previewLocationOrigin:a,previewLocationRoute:i,perspective:n,targetOrigin:s}=r,c=new URL(i,a||s);c.searchParams.set(Oe,ze(n));const{pathname:o,search:u}=c,p=`${a}${o}${u}`,{t:d}=ge(we);let m;e[0]!==t?(m=y=>{y.preventDefault(),t(y.currentTarget.href)},e[0]=t,e[1]=m):m=e[1];const h=m;let v;e[2]!==d?(v=d("share-url.menu-item.open.text"),e[2]=d,e[3]=v):v=e[3];let g;e[4]!==v?(g=l.jsx(Z,{size:1,children:v}),e[4]=v,e[5]=g):g=e[5];let x;e[6]===Symbol.for("react.memo_cache_sentinel")?(x=["bottom-start"],e[6]=x):x=e[6];let w;e[7]!==d?(w=d("share-url.menu-item.open.text"),e[7]=d,e[8]=w):w=e[8];let P;e[9]!==h||e[10]!==p||e[11]!==w?(P=l.jsx(Ee,{as:"a","aria-label":w,icon:An,mode:"bleed",href:p,rel:"opener",target:"_blank",tooltipProps:null,onClick:h}),e[9]=h,e[10]=p,e[11]=w,e[12]=P):P=e[12];let S;return e[13]!==g||e[14]!==P?(S=l.jsx(Ve,{animate:!0,content:g,fallbackPlacements:x,placement:"bottom",portal:!0,children:P}),e[13]=g,e[14]=P,e[15]=S):S=e[15],S}function br(r){const e=X(r,pi);if(!e)throw new TypeError("targetOrigin is required");return e}function pi(r){return r.context.previewUrl?.origin}function mi(r){const e=L.c(32),{fontSize:t,onChange:a,padding:i,prefix:n,suffix:s,value:c,previewUrlRef:o}=r,u=t===void 0?1:t,p=i===void 0?3:i,d=Ct(o),m=br(o),{t:h}=ge(we),{basePath:v}=Jt()?.activeWorkspace||{},g=v===void 0?"/":v,x=f.useRef(null),[w,P]=f.useState(void 0),[S,y]=f.useState(void 0);let b;e[0]===Symbol.for("react.memo_cache_sentinel")?(b=Q=>{P(Q.currentTarget.value)},e[0]=b):b=e[0];const _=b;let E;e[1]!==d||e[2]!==g||e[3]!==a||e[4]!==w||e[5]!==h||e[6]!==m?(E=Q=>{if(Q.key==="Enter"){if(w===void 0)return;let J=w;try{J=new URL(w,m).toString()}catch{}if(Array.isArray(d)){if(!d.some(ee=>ee.test(J))){y(h("preview-location-input.error",{origin:m,context:"origin-not-allowed"})),Q.currentTarget.reportValidity();return}}else if(!m&&(J.startsWith(`${g}/`)||J===g)){y(h("preview-location-input.error",{basePath:g,context:"same-base-path"}));return}const te=J===m?`${m}/`:J;y(void 0),P(void 0),a(te),x.current?.blur()}Q.key==="Escape"&&(y(void 0),P(void 0))},e[1]=d,e[2]=g,e[3]=a,e[4]=w,e[5]=h,e[6]=m,e[7]=E):E=e[7];const R=E;let C;e[8]===Symbol.for("react.memo_cache_sentinel")?(C=()=>{y(void 0),P(void 0)},e[8]=C):C=e[8];const j=C;let M;e[9]!==m||e[10]!==c?(M=()=>{y(void 0);let Q=c;try{Q=new URL(c,m).toString()}catch{}P(Q)},e[9]=m,e[10]=c,e[11]=M):M=e[11];const k=M;let I;e[12]===Symbol.for("react.memo_cache_sentinel")?(I=()=>{y(void 0),P(void 0)},e[12]=I):I=e[12];let $;e[13]!==m||e[14]!==c?($=[m,c],e[13]=m,e[14]=c,e[15]=$):$=e[15],f.useEffect(I,$);let U;e[16]===Symbol.for("react.memo_cache_sentinel")?(U={icon:Tn},e[16]=U):U=e[16];const B=S?U:void 0;let q;e[17]===Symbol.for("react.memo_cache_sentinel")?(q={zIndex:1},e[17]=q):q=e[17];let K;e[18]!==w||e[19]!==m||e[20]!==c?(K=w===void 0?new URL(c,m).toString():w,e[18]=w,e[19]=m,e[20]=c,e[21]=K):K=e[21];let F;return e[22]!==S||e[23]!==u||e[24]!==k||e[25]!==R||e[26]!==p||e[27]!==n||e[28]!==s||e[29]!==B||e[30]!==K?(F=l.jsx(l.Fragment,{children:l.jsx(Sn,{clearButton:B,customValidity:S,fontSize:u,onBlur:j,onClear:k,onChange:_,onKeyDownCapture:R,padding:p,prefix:n,style:q,radius:2,ref:x,space:p,suffix:s,value:K})}),e[22]=S,e[23]=u,e[24]=k,e[25]=R,e[26]=p,e[27]=n,e[28]=s,e[29]=B,e[30]=K,e[31]=F):F=e[31],F}const hi=f.lazy(()=>Re(()=>import("./QRCodeSVG-CHDLHmKj.js"),__vite__mapDeps([0,1]))),ht=24,fi=16,vi=224,gi=fe(Mn)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: ${ht}px;
  width: ${ht}px;
`,wi=He.create(Xe),yi=He.create(Z),xi=He.create(gi),Pr=f.memo(function(r){const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:t,initialUrl:a,previewLocationRoute:i,perspective:n}=r,{t:s}=ge(we),{push:c}=tt(),o=et({apiVersion:nt}),u=Xt(),[p,d]=f.useState(!0),[m,h]=f.useState(!1),[v,g]=f.useState(!1),[x,w]=f.useState(null),P=m||v||p,S=f.useMemo(()=>x?Qn(a,x,i,ze(n)):null,[a,n,i,x]),[y,b]=f.useState(null);if(y)throw y;const _=f.useCallback(()=>{c({closable:!0,status:"warning",title:s("share-preview-menu.error_toggle-sharing",{context:"toggle-sharing"})})},[c,s]),E=f.useCallback(async()=>{try{g(!0),await Jn(o,"sanity/presentation",typeof window>"u"?"":location.href,u?.id),w(null)}catch(j){b(j)}finally{g(!1)}},[o,u?.id]),R=f.useCallback(async()=>{try{h(!0);const j=await Xn(o,"sanity/presentation",typeof window>"u"?"":location.href,u?.id);w(j.secret)}catch(j){b(j)}finally{h(!1)}},[o,u?.id]),C=f.useCallback(()=>{try{if(!S)throw new Error("No URL to copy");navigator.clipboard.writeText(S.toString()),c({closable:!0,status:"success",title:s("share-url.clipboard.status",{context:"success"})})}catch(j){b(j)}},[c,s,S]);return f.useEffect(()=>{let j=new AbortController,M=[];async function k($,U){const{result:B,syncTags:q}=await o.fetch(sr,{},{filterResponse:!1,lastLiveEventId:$,tag:"presentation.fetch-shared-access-secret"});Array.isArray(q)&&(M=q),U.aborted||w(B)}const I=o.live.events().subscribe({next:$=>{$.type==="message"&&(j.abort(),j=new AbortController,$.tags.some(U=>M.includes(U))&&k($.id,j.signal))},error:b});return k(null,j.signal).finally(()=>d(!1)),()=>{I.unsubscribe(),j.abort()}},[o]),l.jsx(cn,{button:l.jsx(Ee,{"aria-label":s("preview-frame.share-button.aria-label"),icon:hn,mode:"bleed",tooltipProps:null}),id:"share-menu",menu:l.jsx(ln,{style:{maxWidth:248},padding:t?void 0:0,children:t?l.jsxs(l.Fragment,{children:[l.jsx("label",{style:{cursor:"pointer"},children:l.jsxs(un,{columns:2,rows:2,gapX:3,gapY:1,style:{justifyContent:"center",alignItems:"center",gridTemplateColumns:"min-content 1fr",gridTemplateRows:"min-content"},paddingTop:3,paddingX:3,children:[l.jsx(Ve,{animate:!0,content:l.jsx(Z,{size:1,children:s("share-preview-menu.toggle-button.tooltip",{context:S?"disable":"enable"})}),fallbackPlacements:["bottom-start"],placement:"bottom",portal:!0,children:l.jsx(ir,{checked:m||S!==null&&!v,readOnly:m||v,indeterminate:p,onChange:e?S?E:R:_})}),l.jsx(Z,{size:1,weight:"medium",children:s("share-preview-menu.toggle-button.label",{context:"first-line"})}),l.jsx("span",{}),l.jsx(Z,{muted:!0,size:1,children:s("share-preview-menu.toggle-button.label",{context:"second-line"})})]})}),l.jsx(he,{padding:3,paddingTop:2,children:l.jsxs(Ie,{space:3,children:[l.jsx(ue,{tone:P||!S?"transparent":void 0,style:{position:"relative",aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx(nr,{children:P?l.jsx(wi,{muted:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}):S?l.jsx(l.Fragment,{children:l.jsxs(f.Suspense,{fallback:l.jsx(Xe,{}),children:[l.jsx(hi,{title:s("share-preview-menu.qr-code.title",{url:S.toString()}),value:S.toString(),size:vi,color:"var(--card-fg-color)",logoSize:ht+fi}),l.jsx(xi,{initial:{opacity:-.5},animate:{opacity:1.5},exit:{opacity:0}})]})}):l.jsx(yi,{muted:!0,size:1,style:{maxWidth:"100px",textWrap:"pretty",textAlign:"center"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:s("share-preview-menu.qr-code.placeholder")})})}),l.jsx(Z,{muted:!0,size:1,children:s("share-preview-menu.qr-code.instructions")})]})}),l.jsx(dn,{}),l.jsx(pn,{disabled:!S||v,icon:mn,onClick:C,text:s("share-preview-menu.copy-url.text")})]}):l.jsx(ue,{padding:2,tone:"caution",radius:3,children:l.jsx(Z,{style:{textWrap:"pretty"},children:s("share-preview-menu.error",{context:"missing-grants"})})})}),popover:{constrainSize:!0,placement:"bottom",portal:!0}})});Pr.displayName="Memo(SharePreviewMenu)";const bi=r=>{const e=L.c(107),{canSharePreviewAccess:t,canToggleSharePreviewAccess:a,canUseSharedPreviewAccess:i,iframeRef:n,initialUrl:s,navigatorEnabled:c,onPathChange:o,onRefresh:u,openPopup:p,overlaysConnection:d,presentationRef:m,perspective:h,previewUrl:v,setViewport:g,targetOrigin:x,toggleNavigator:w,toggleOverlay:P,viewport:S,previewUrlRef:y}=r,{t:b}=ge(we);let _;e[0]!==g||e[1]!==S?(_=()=>g(S==="desktop"?"mobile":"desktop"),e[0]=g,e[1]=S,e[2]=_):_=e[2];const E=_,R=x===location.origin?"":x;let C;e[3]!==n||e[4]!==u||e[5]!==m||e[6]!==v||e[7]!==x?(C=()=>{u(()=>{n.current&&(m.send({type:"iframe reload"}),Object.assign(n.current,{src:`${x}${v||"/"}`}))})},e[3]=n,e[4]=u,e[5]=m,e[6]=v,e[7]=x,e[8]=C):C=e[8];const j=C,M=X(m,_i),k=X(m,ji),I=X(m,Ei),$=X(m,Ri),U=X(m,Ci),B=new URL(v||"/",x),{pathname:q,search:K}=qn(B),F=`${q}${K}`,Q=xr(),J=X(y,ki);let te;e[9]===Symbol.for("react.memo_cache_sentinel")?(te={width:"100%"},e[9]=te):te=e[9];let ee;e[10]!==c||e[11]!==b||e[12]!==w?(ee=w&&l.jsx(Ee,{"aria-label":b("preview-frame.navigator.toggle-button.aria-label"),icon:en,mode:"bleed",onClick:w,selected:c,tooltipProps:{content:l.jsx(Z,{size:1,children:b("preview-frame.navigator.toggle-button.tooltip")}),fallbackPlacements:["bottom-start"],placement:"bottom"}}),e[10]=c,e[11]=b,e[12]=w,e[13]=ee):ee=e[13];let oe;e[14]===Symbol.for("react.memo_cache_sentinel")?(oe={whiteSpace:"nowrap"},e[14]=oe):oe=e[14];const ce=U?"disable":"enable";let re;e[15]!==b||e[16]!==ce?(re=b("preview-frame.overlay.toggle-button.tooltip",{context:ce}),e[15]=b,e[16]=ce,e[17]=re):re=e[17];let O;e[18]!==re?(O=l.jsx(he,{padding:1,children:l.jsx(Z,{size:1,children:re})}),e[18]=re,e[19]=O):O=e[19];let H;e[20]===Symbol.for("react.memo_cache_sentinel")?(H=l.jsx(he,{paddingY:1,children:l.jsx(fn,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})}),e[20]=H):H=e[20];let N;e[21]!==O?(N=l.jsxs(ie,{align:"center",style:oe,children:[O,H]}),e[21]=O,e[22]=N):N=e[22];let G;e[23]===Symbol.for("react.memo_cache_sentinel")?(G=["bottom-start"],e[23]=G):G=e[23];let ne;e[24]===Symbol.for("react.memo_cache_sentinel")?(ne={lineHeight:0,borderRadius:999,userSelect:"none"},e[24]=ne):ne=e[24];const se=U?"transparent":void 0;let T;e[25]===Symbol.for("react.memo_cache_sentinel")?(T={margin:-4},e[25]=T):T=e[25];const V=!k,z=M||d!=="connected";let de;e[26]!==U||e[27]!==V||e[28]!==z||e[29]!==P?(de=l.jsx("div",{style:T,children:l.jsx(ir,{indeterminate:V,checked:U,onChange:P,disabled:z})}),e[26]=U,e[27]=V,e[28]=z,e[29]=P,e[30]=de):de=e[30];const _e=!U;let ye;e[31]!==b?(ye=b("preview-frame.overlay.toggle-button.text"),e[31]=b,e[32]=ye):ye=e[32];let xe;e[33]!==_e||e[34]!==ye?(xe=l.jsx(he,{children:l.jsx(Z,{muted:_e,size:1,weight:"medium",children:ye})}),e[33]=_e,e[34]=ye,e[35]=xe):xe=e[35];let me;e[36]!==de||e[37]!==xe?(me=l.jsxs(ie,{align:"center",gap:3,children:[de,xe]}),e[36]=de,e[37]=xe,e[38]=me):me=e[38];let be;e[39]!==se||e[40]!==me?(be=l.jsx(ue,{as:"label",flex:"none",padding:3,marginX:1,style:ne,tone:se,children:me}),e[39]=se,e[40]=me,e[41]=be):be=e[41];let Pe;e[42]!==be||e[43]!==N?(Pe=l.jsx(Ve,{animate:!0,content:N,fallbackPlacements:G,placement:"bottom",portal:!0,children:be}),e[42]=be,e[43]=N,e[44]=Pe):Pe=e[44];let je;e[45]!==k||e[46]!==M||e[47]!==I||e[48]!==$||e[49]!==b?(je=k?b("preview-frame.refresh-button.tooltip"):b("preview-frame.status",{context:M?"loading":I?"refreshing":$?"reloading":"unknown"}),e[45]=k,e[46]=M,e[47]=I,e[48]=$,e[49]=b,e[50]=je):je=e[50];let Ce;e[51]!==je?(Ce=l.jsx(Z,{size:1,children:je}),e[51]=je,e[52]=Ce):Ce=e[52];let Me;e[53]===Symbol.for("react.memo_cache_sentinel")?(Me=["bottom-end"],e[53]=Me):Me=e[53];let ke;e[54]!==b?(ke=b("preview-frame.refresh-button.aria-label"),e[54]=b,e[55]=ke):ke=e[55];const We=$||I||J;let A;e[56]!==j||e[57]!==ke||e[58]!==We?(A=l.jsx(Ee,{"aria-label":ke,icon:vn,mode:"bleed",loading:We,onClick:j,tooltipProps:null}),e[56]=j,e[57]=ke,e[58]=We,e[59]=A):A=e[59];let W;e[60]!==Ce||e[61]!==A?(W=l.jsx(he,{padding:1,children:l.jsx(Ve,{animate:!0,content:Ce,fallbackPlacements:Me,placement:"bottom",portal:!0,children:A})}),e[60]=Ce,e[61]=A,e[62]=W):W=e[62];let D;e[63]!==p||e[64]!==h||e[65]!==R||e[66]!==F||e[67]!==x?(D=l.jsx(he,{padding:1,children:l.jsx(di,{openPopup:p,previewLocationOrigin:R,previewLocationRoute:F,perspective:h,targetOrigin:x})}),e[63]=p,e[64]=h,e[65]=R,e[66]=F,e[67]=x,e[68]=D):D=e[68];let Se;e[69]!==o||e[70]!==F||e[71]!==y||e[72]!==W||e[73]!==D?(Se=l.jsx(he,{flex:1,children:l.jsx(mi,{previewUrlRef:y,prefix:W,onChange:o,suffix:D,value:F})}),e[69]=o,e[70]=F,e[71]=y,e[72]=W,e[73]=D,e[74]=Se):Se=e[74];let le;e[75]!==Q?(le=Rr=>{Rr?.style.setProperty("view-transition-name",Q)},e[75]=Q,e[76]=le):le=e[76];const Ne=S==="desktop"?"narrow":"full";let Ae;e[77]!==b||e[78]!==Ne?(Ae=b("preview-frame.viewport-button.tooltip",{context:Ne}),e[77]=b,e[78]=Ne,e[79]=Ae):Ae=e[79];let ve;e[80]!==Ae?(ve=l.jsx(Z,{size:1,children:Ae}),e[80]=Ae,e[81]=ve):ve=e[81];let Ge;e[82]===Symbol.for("react.memo_cache_sentinel")?(Ge=["bottom-start"],e[82]=Ge):Ge=e[82];let Ue;e[83]!==b?(Ue=b("preview-frame.viewport-button.aria-label"),e[83]=b,e[84]=Ue):Ue=e[84];const at=S==="desktop"?tn:rn;let $e;e[85]!==Ue||e[86]!==at||e[87]!==E||e[88]!==S?($e=l.jsx(Ee,{"data-testid":"preview-viewport-toggle","data-viewport":S,"aria-label":Ue,icon:at,mode:"bleed",onClick:E,tooltipProps:null}),e[85]=Ue,e[86]=at,e[87]=E,e[88]=S,e[89]=$e):$e=e[89];let Le;e[90]!==le||e[91]!==ve||e[92]!==$e?(Le=l.jsx(ie,{align:"center",flex:"none",gap:1,children:l.jsx(Ve,{animate:!0,ref:le,content:ve,fallbackPlacements:Ge,placement:"bottom",portal:!0,children:$e})}),e[90]=le,e[91]=ve,e[92]=$e,e[93]=Le):Le=e[93];let De;e[94]!==t||e[95]!==a||e[96]!==i||e[97]!==s||e[98]!==h||e[99]!==F?(De=t&&l.jsx(ie,{align:"center",flex:"none",gap:1,children:l.jsx(Pr,{canToggleSharePreviewAccess:a,canUseSharedPreviewAccess:i,previewLocationRoute:F,initialUrl:s,perspective:h})}),e[94]=t,e[95]=a,e[96]=i,e[97]=s,e[98]=h,e[99]=F,e[100]=De):De=e[100];let qe;return e[101]!==Pe||e[102]!==ee||e[103]!==Se||e[104]!==Le||e[105]!==De?(qe=l.jsxs(ie,{align:"center",gap:1,paddingX:1,style:te,children:[ee,Pe,Se,Le,De]}),e[101]=Pe,e[102]=ee,e[103]=Se,e[104]=Le,e[105]=De,e[106]=qe):qe=e[106],qe};function Pi(r){const e=L.c(7),t=Si,a=r.options?.component;let i;e[0]!==a||e[1]!==r?(i=a?l.jsx(a,{...r,renderDefault:t}):t(r),e[0]=a,e[1]=r,e[2]=i):i=e[2];const n=i;let s;e[3]===Symbol.for("react.memo_cache_sentinel")?(s={position:"relative"},e[3]=s):s=e[3];let c;e[4]===Symbol.for("react.memo_cache_sentinel")?(c={minHeight:0},e[4]=c):c=e[4];let o;return e[5]!==n?(o=l.jsx(ue,{flex:"none",padding:2,borderBottom:!0,style:s,children:l.jsx(ie,{align:"center",style:c,children:n})}),e[5]=n,e[6]=o):o=e[6],o}function Si(r){return l.jsx(bi,{...r})}function _i(r){return r.matches("loading")}function ji(r){return r.matches("loaded")}function Ei(r){return r.matches({loaded:"refreshing"})}function Ri(r){return r.matches({loaded:"reloading"})}function Ci(r){return r.context.visualEditingOverlaysEnabled}function ki(r){return r.hasTag("busy")}const ot=He.create(ie),Sr=f.memo(f.forwardRef(function(r,e){const{header:t,initialUrl:a,loadersConnection:i,overlaysConnection:n,perspective:s,viewport:c,vercelProtectionBypass:o,presentationRef:u,previewUrlRef:p}=r,[d,m]=f.useState(null),h=ze(d===null?s:d),v=f.useMemo(()=>{const T=new URL(a);return T.searchParams.get(Oe)||T.searchParams.set(Oe,h),(o||T.searchParams.get(Fe))&&T.searchParams.set(gt,"samesitenone"),o&&!T.searchParams.get(Fe)&&T.searchParams.set(Fe,o),T},[a,h,o]);f.useEffect(()=>{i==="connected"&&m(T=>T===null?s:T)},[i,s]);const{t:g}=ge(we),{devMode:x}=St(),w=Qr(),P=f.useRef(null),S=l.jsx(Pi,{...r,iframeRef:P,options:t});f.useImperativeHandle(e,()=>P.current);const y=X(u,T=>T.matches("loading")||T.matches({loaded:"reloading"})),[b,_]=f.useState(!1),E=X(u,T=>T.matches({loaded:"refreshing"})),[R,C]=f.useState(!1),j=y||E||n==="connecting",M=f.useCallback(()=>{P.current&&(P.current.src=v.toString(),u.send({type:"iframe reload"}))},[u,v]),k=f.useCallback(()=>{$(!0)},[]),[I,$]=f.useState(!1),[U,B]=f.useState(!1);f.useEffect(()=>{if(!(y||E)&&(n==="connecting"||n==="reconnecting")){const T=setTimeout(()=>{B(!0)},5e3);return()=>clearTimeout(T)}},[n,y,E]),f.useEffect(()=>{if(!(y||E||!U)){if(n==="connected"&&(C(!1),B(!1),_(!1),$(!1)),n==="connecting"){const T=setTimeout(()=>{_(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},At);return()=>clearTimeout(T)}if(n==="reconnecting"){const T=setTimeout(()=>{_(!0),C(!0)},At);return()=>clearTimeout(T)}}},[y,n,E,U]);const q=f.useCallback(()=>{u.send({type:"iframe loaded"})},[u]),K=f.useMemo(()=>(y||n==="connecting"&&!E)&&!I,[I,y,E,n]),F=f.useSyncExternalStore(f.useCallback(()=>()=>{},[]),()=>CSS.supports("(view-transition-name: test)")),Q=f.useMemo(()=>[K?"background":"active",y?"reloading":"idle",F?"":c,U&&!I?"timedOut":""],[F,I,y,K,U,c]),[J,te]=f.useState(c),[ee,oe]=f.useState(ct[c]);f.useEffect(()=>{if(F&&c!==J){const T=()=>{te(c),oe(ct[c])};!w&&"startViewTransition"in document&&typeof document.startViewTransition=="function"?document.startViewTransition({update:()=>Xr.flushSync(()=>T()),types:["sanity-iframe-viewport"]}):T()}},[F,w,J,c]);const ce=tt(),re=Ct(p),[O,H]=f.useState(!1),[N]=f.useState(new Set),G=Qe(T=>{if(re.some(V=>V.test(T))){H(T);return}N.has(T)||(N.add(T),console.warn("Visual Editing is here but misconfigured",{reportedOrigin:T}),ce.push({closable:!0,id:`presentation-iframe-origin-mismatch-${T}`,status:"error",duration:1/0,title:g("preview-frame.configuration.error.title"),description:l.jsx(_t,{t:g,i18nKey:"preview-frame.configuration.error.description",components:{Code:"code"},values:{targetOrigin:v.origin,reportedOrigin:T}})}))}),ne=Jr(),se=Qe(T=>{if(!O)return;const V=new URL(T,O);ne(`${O}${V.pathname}${V.search}${V.hash}`)});return f.useEffect(()=>{if(!O)return;const T=P.current?.contentWindow;if(!T)return;const V=rr({targetOrigin:O});V.addTarget(T);const z=V.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},dt().provide({actors:pt()}));z.on("visual-editing/navigate",_e=>{se(_e.url)});const de=z.start();return()=>{de(),V.destroy()}},[O]),f.useEffect(()=>{if(n==="connecting"||n==="reconnecting"){const T=setInterval(()=>{P.current?.contentWindow?.postMessage({domain:"sanity/channels",from:"presentation",type:"presentation/status"},"*")},1e3),V=new AbortController;return window.addEventListener("message",({data:z})=>{z&&typeof z=="object"&&"domain"in z&&z.domain==="sanity/channels"&&"type"in z&&z.type==="visual-editing/status"&&"data"in z&&typeof z.data=="object"&&z.data&&"origin"in z.data&&typeof z.data.origin=="string"&&G(z.data.origin)},{signal:V.signal}),()=>{V.abort(),clearInterval(T)}}},[n,b]),l.jsx(Dn,{transition:w?{duration:0}:void 0,children:l.jsxs(Yr,{children:[S,l.jsx(ue,{flex:1,tone:"transparent",children:l.jsxs(ie,{align:"center",height:"fill",justify:"center",padding:(F?J:c)==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:j?"wait":void 0},children:[l.jsx(nr,{children:!R&&!y&&!E&&U&&!I?l.jsx(ot,{initial:"initial",animate:"animate",exit:"exit",variants:Lt,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:b?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:b?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:l.jsxs(ie,{style:{...Ze[c]},justify:"center",align:"center",direction:"column",gap:4,children:[b&&l.jsx(Ee,{disabled:!0,mode:"ghost",text:g("preview-frame.continue-button.text"),style:{opacity:0}}),l.jsx(ue,{radius:2,tone:b?"caution":"inherit",padding:4,shadow:1,children:l.jsxs(ie,{justify:"center",align:"center",direction:"column",gap:4,children:[l.jsx(Xe,{muted:!0}),l.jsx(Z,{muted:!0,size:1,children:b?g("preview-frame.status",{context:"timeout"}):g("preview-frame.status",{context:"connecting"})})]})}),b&&l.jsx(Ee,{tone:"critical",onClick:k,text:g("preview-frame.continue-button.text")})]})}):(y||n==="connecting"&&!E)&&!I?l.jsx(ot,{initial:"initial",animate:"animate",exit:"exit",variants:Lt,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:l.jsxs(ie,{style:{...Ze[c]},justify:"center",align:"center",direction:"column",gap:4,children:[l.jsx(Xe,{muted:!0}),l.jsx(Z,{muted:!0,size:1,children:g("preview-frame.status",{context:"loading"})})]})}):R&&!I?l.jsx(ot,{initial:"initial",animate:"animate",exit:"exit",variants:Ai,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute"},children:l.jsx(Rt,{flex:1,message:g("preview-frame.connection.error.text"),onRetry:M,onContinueAnyway:k,children:x&&l.jsxs(l.Fragment,{children:[n!=="connected"&&l.jsx(ue,{padding:3,radius:2,tone:"critical",children:l.jsxs(Ie,{space:3,children:[l.jsx(Je,{muted:!0,size:0,children:g("preview-frame.overlay.connection-status.label")}),l.jsx(Ye,{size:1,children:g("channel.status",{context:n})})]})}),i!=="connected"&&l.jsx(ue,{padding:3,radius:2,tone:"critical",children:l.jsxs(Ie,{space:3,children:[l.jsx(Je,{muted:!0,size:0,children:g("preview-frame.loader.connection-status.label")}),l.jsx(Ye,{size:1,children:g("channel.status",{context:i})})]})})]})})}):null}),l.jsx(oi,{animate:Q,initial:["background"],onLoad:q,preventClick:K,ref:P,src:v.toString(),style:ee,variants:ct})]})})]})})}));Sr.displayName="Memo(ForwardRef(Preview))";const Ze={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},Lt={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},Ai={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},ct={desktop:{...Ze.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...Ze.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};function Ti(){let r=!1;return(...e)=>{r||(console.warn(...e),r=!0)}}const Mi=Ti();function Ii(r,e){const t=L.c(11);Br(r);let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a={},t[0]=a):a=t[0];const[i,n]=f.useState(a);let s;t[1]===Symbol.for("react.memo_cache_sentinel")?(s={},t[1]=s):s=t[1];const[c,o]=f.useState(s),u=f.useRef("");let p;t[2]!==e?(p=(P,S,y)=>{const b=(y===void 0?[]:y).filter($i);(S==="published"?n:o)(_=>{const E={};for(const C of b)E[C._id]=C;if(u.current!==e.current.url)return u.current=e.current.url,{[P]:E};const R=_[P];return Ln(R,E)?_:{..._,[P]:E}})},t[2]=e,t[3]=p):p=t[3];const d=p,m=r==="published"?i:c;let h;t[4]!==m?(h=Object.values(m).reduce(Ui,{}),t[4]=m,t[5]=h):h=t[5];const v=h;let g;t[6]!==v?(g=Object.values(v),t[6]=v,t[7]=g):g=t[7];const x=g;let w;return t[8]!==x||t[9]!==d?(w=[x,d],t[8]=x,t[9]=d,t[10]=w):w=t[10],w}function Ui(r,e){return Object.values(e).forEach(t=>{r[t._id]=t}),r}function $i(r){return"_projectId"in r&&r._projectId?(Mi("Cross dataset references are not supported yet, ignoring source document",r),!1):r}function _r(r,e){return r instanceof Function?r(e):r}function Li(r,e){if(r.resolve){const t=r.resolve(e)?.filter;return t?`// groq
*[${t}][0]{_id, _type}`:void 0}return"type"in r?`// groq
*[_type == "${r.type}"][0]{_id, _type}`:`// groq
*[${_r(r.filter,e)}][0]{_id, _type}`}function Di(r,e){return r.resolve?r.resolve(e)?.params??e.params:"type"in r?{}:_r(r.params,e)??e.params}function Oi(r,e){const t=Array.isArray(r)?r:[r];for(r of t){let{origin:a}=e,i=r;if(typeof r=="string")try{const n=new URL(r);if(n.origin!==a)continue;a=n.origin,i=n.pathname}catch{}try{const n=ea(i,{decode:decodeURIComponent})(e.pathname);if(n){const{params:s,path:c}=n;return{origin:a,params:s,path:c}}}catch(n){throw new Error(`"${r}" is not a valid route pattern`,{cause:n})}}}function zi(r){const e=L.c(22),{navigate:t,navigationHistory:a,path:i,targetOrigin:n,resolvers:s}=r;let c;e[0]!==s?(c=s===void 0?[]:s,e[0]=s,e[1]=c):c=e[1];const o=c,{state:u}=Ke(),{perspectiveStack:p}=bt();let d;e[2]===Symbol.for("react.memo_cache_sentinel")?(d={apiVersion:nt},e[2]=d):d=e[2];const m=et(d);let h;e[3]!==i||e[4]!==u?(h=i||u._searchParams?.find(Wi)?.[1]||"",e[3]=i,e[4]=u,e[5]=h):h=e[5];const v=h,[g,x]=f.useState(void 0),w=f.useRef(void 0);let P;e[6]!==t||e[7]!==a?(P=(_,E)=>{(!_||w.current!==_._id)&&(x({document:_,path:E.pathname}),w.current=_?._id,a.at(-1)?.id===a.at(-2)?.id&&t?.({state:{id:_?._id,type:_?._type}}))},e[6]=t,e[7]=a,e[8]=P):P=e[8];const S=Qe(P);let y;e[9]!==m||e[10]!==S||e[11]!==p||e[12]!==v||e[13]!==o||e[14]!==n?(y=()=>{const _=new URL(v,n);if(o.length){let E;for(const R of o){const C=Oi(R.route,_);if(C){E={context:C,resolver:R};break}}if(E){const R=Li(E.resolver,E.context),C=Di(E.resolver,E.context);if(R){const j=new AbortController,M={perspective:p,signal:j.signal,tag:"use-main-document"};return m.fetch(R,C,M).then(k=>S(k,_)).catch(k=>{k instanceof Error&&k.name==="AbortError"||(x({document:void 0,path:_.pathname}),w.current=void 0)}),()=>{j.abort()}}}}x(void 0),w.current=void 0},e[9]=m,e[10]=S,e[11]=p,e[12]=v,e[13]=o,e[14]=n,e[15]=y):y=e[15];let b;return e[16]!==m||e[17]!==p||e[18]!==v||e[19]!==o||e[20]!==n?(b=[m,p,v,o,n],e[16]=m,e[17]=p,e[18]=v,e[19]=o,e[20]=n,e[21]=b):b=e[21],f.useEffect(y,b),g}function Wi(r){const[e]=r;return e==="preview"}const Ni=/^([\w-]+):(0|[1-9][0-9]*)$/,Fi=/^([\w-]+):([0-9]+),([0-9]+)$/,Vi=/^([\w-]+):([\w-]+)$/;function Bi(r){const e=[];for(const t of r.split(".")){const a=Ni.exec(t);if(a){e.push(a[1],Number(a[2]));continue}const i=Fi.exec(t);if(i){e.push(i[1],[Number(i[2]),Number(i[3])]);continue}const n=Vi.exec(t);if(n){e.push(n[1],{_key:n[2]});continue}e.push(t)}return e}function Ki(r){if(r===void 0)return;const e=decodeURIComponent(r)?.split(".");return e[0]==="drafts"&&e.shift(),e.join(".")}function Hi(r){if(r!==void 0)return ar.toString(Bi(decodeURIComponent(r)))}function Gi(r){return{id:Ki(r.id),path:Hi(r.path),type:r.type}}function Dt(r){return Object.fromEntries(Object.entries(r).filter(([,e])=>e!==void 0&&e!==""&&e!==null))}const jr=()=>r=>r,qi=jr()(["perspective","preview","viewport"]),Qi=jr()(["changesInspectorTab","comment","inspect","instruction","parentRefPath","path","pathKey","rev","since","template","templateParams","version","view"]);function Xi({initialPreviewUrl:r,routerNavigate:e,routerState:t,routerSearchParams:a,frameStateRef:i}){const n=f.useMemo(()=>{const{id:h,path:v,type:g}=Gi(t);return{id:h,type:g,path:v,preview:a.preview||r.toString(),perspective:a.perspective,viewport:a.viewport,inspect:a.inspect,parentRefPath:a.parentRefPath,rev:a.rev,since:a.since,template:a.template,templateParams:a.templateParams,view:a.view,pathKey:a.pathKey,instruction:a.instruction,comment:a.comment,changesInspectorTab:a.changesInspectorTab}},[t,a,r]),s=f.useMemo(()=>Dt({inspect:n.inspect,path:n.path,parentRefPath:n.parentRefPath,rev:n.rev,since:n.since,template:n.template,templateParams:n.templateParams,view:n.view,pathKey:n.pathKey,instruction:n.instruction,comment:n.comment,changesInspectorTab:n.changesInspectorTab}),[n.changesInspectorTab,n.comment,n.inspect,n.instruction,n.path,n.pathKey,n.parentRefPath,n.rev,n.since,n.template,n.templateParams,n.view]),c=f.useMemo(()=>Dt({perspective:n.perspective,preview:n.preview,viewport:n.viewport}),[n.perspective,n.preview,n.viewport]),o=f.useRef(t);f.useLayoutEffect(()=>{o.current=t},[t]);const[u,p]=f.useState([t]),d=f.useCallback(({id:h,type:v})=>{const{current:g}=o;return h===g.id&&v===g.type},[]),m=f.useCallback(h=>{const{state:v,params:g,replace:x=!1}=h;v?.id&&(v.id=rt(v.id));const{current:w}=o,P={id:w.id,type:w.type,path:w.path},S=Object.fromEntries(w._searchParams||[]),y=v||P,b={...[...qi,...d(y)?Qi:[]].reduce((E,R)=>(E[R]=S[R],E),{}),...g},_={...y,_searchParams:Object.entries(b).reduce((E,[R,C])=>[...E,[R,C]],[])};p(E=>[...E,_]),e(_,{replace:x})},[d,e]);return{isSameDocument:d,navigate:m,navigationHistory:u,params:n,searchParams:c,structureParams:s}}const Ji=r=>{const e=L.c(10),[t,a]=f.useState(Yi);let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=d=>{const m=window.open(d,"_blank");m&&a(h=>new Set(h).add(m))},e[0]=i):i=e[0];const n=i;let s,c;e[1]!==r||e[2]!==t?(s=()=>{const d=[];if(t.size&&r)for(const m of t)m&&"closed"in m&&!m.closed&&d.push(r.addTarget(m));return()=>{d.forEach(Zi)}},c=[r,t],e[1]=r,e[2]=t,e[3]=s,e[4]=c):(s=e[3],c=e[4]),f.useEffect(s,c);let o,u;e[5]!==t?(o=()=>{if(t.size){const d=setInterval(()=>{const m=new Set;for(const h of t)h&&"closed"in h&&h.closed&&m.add(h);m.size&&a(h=>{const v=new Set(h);for(const g of m)v.delete(g);return v})},gn);return()=>{clearInterval(d)}}},u=[t],e[5]=t,e[6]=o,e[7]=u):(o=e[6],u=e[7]),f.useEffect(o,u);let p;return e[8]!==t?(p={popups:t,open:n},e[8]=t,e[9]=p):p=e[9],p};function Yi(){return new Set}function Zi(r){return r()}function Er(){const{perspectiveStack:r,selectedPerspectiveName:e,selectedReleaseId:t}=bt();return t?r:e===void 0?"drafts":e}function lt(){const r=L.c(4);let e;r[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,r[0]=e):e=r[0];const[t,a]=f.useState(e);let i;e:{const u=Array.from(t.values());if(u.find(rs)){i="connected";break e}const p=u.filter(ts);if(p.length){i=p.some(es)?"connecting":"reconnecting";break e}i="idle"}const n=i;let s;r[1]===Symbol.for("react.memo_cache_sentinel")?(s=u=>{a(p=>{const d=new Map(p);if(u.status==="disconnected")d.delete(u.connection);else{const m=d.get(u.connection)?.hasConnected||u.status==="connected",h=u.status==="handshaking"?"connecting":u.status;d.set(u.connection,{status:h,hasConnected:m})}return d})},r[1]=s):s=r[1];const c=s;let o;return r[2]!==n?(o=[n,c],r[2]=n,r[3]=o):o=r[3],o}function es(r){const{hasConnected:e}=r;return!e}function ts(r){const{status:e}=r;return e==="connecting"}function rs(r){const{status:e}=r;return e==="connected"}const ns=f.lazy(()=>Re(()=>import("./LiveQueries-CyDYQ7HO.js"),__vite__mapDeps([2,1,3]))),as=f.lazy(()=>Re(()=>import("./PostMessageDocuments-DPQ8q5MZ.js"),__vite__mapDeps([4,1]))),is=f.lazy(()=>Re(()=>import("./PostMessageRefreshMutations-Bvjuq0H3.js"),__vite__mapDeps([5,1]))),ss=f.lazy(()=>Re(()=>import("./PostMessagePerspective-5b6S4zjt.js"),__vite__mapDeps([6,1]))),os=f.lazy(()=>Re(()=>import("./PostMessagePreviewSnapshots-IURQLBv7.js"),__vite__mapDeps([7,1]))),cs=f.lazy(()=>Re(()=>import("./PostMessageSchema-C9shHelp.js"),__vite__mapDeps([8,1]))),ls=f.lazy(()=>Re(()=>import("./PostMessageTelemetry-CRQ2NZFu.js"),__vite__mapDeps([9,1]))),us=fe(ie)`
  overflow-x: auto;
`;function ds(r){const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:t,tool:a,vercelProtectionBypass:i,initialPreviewUrl:n,previewUrlRef:s}=r,c=Ct(s),o=br(s),u=a.options?.components,p=a.name||Lr,{unstable_navigator:d,unstable_header:m}=u||{},{navigate:h,state:v}=Ke(),g=tr(Object.fromEntries(v._searchParams||[])),x=Er(),w=X(s,A=>A.context.previewMode?.shareAccess!==!1),[P]=f.useState(()=>{const A=a.options?.devMode;return typeof A=="function"?A():typeof A=="boolean"?A:typeof window<"u"&&window.location.hostname==="localhost"}),S=f.useRef(null),[y,b]=f.useState(),[_,E]=f.useState(null),R=f.useRef({title:void 0,url:void 0}),{isSameDocument:C,navigate:j,navigationHistory:M,params:k,searchParams:I,structureParams:$}=Xi({initialPreviewUrl:n,routerNavigate:h,routerState:v,routerSearchParams:g,frameStateRef:R}),U=er(da),B=f.useMemo(()=>k.viewport?"mobile":"desktop",[k.viewport]),[q,K]=Ii(x,R),F=Dr(),Q=Or(),J=zi({navigate:j,navigationHistory:M,path:k.preview,targetOrigin:o,resolvers:a.options?.resolve?.mainDocuments}),[te,ee]=lt(),[oe,ce]=lt(),[re,O]=lt(),{open:H}=Ji(y),N=X(U,A=>A.matches("loading"));f.useEffect(()=>{const A=S.current?.contentWindow;if(!A||N)return;const W=rr({targetOrigin:o});return W.addTarget(A),b(W),()=>{W.destroy(),b(void 0)}},[o,N]);const G=Qe(A=>{j(A)});f.useEffect(()=>{if(!y)return;const A=y.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},dt().provide({actors:pt()}));A.on("visual-editing/focus",D=>{"id"in D&&G({state:{type:D.type,id:D.id,path:D.path}})}),A.on("visual-editing/navigate",D=>{const{title:Se}=D;let le=D.url;if(!le.startsWith("http"))try{le=new URL(le,o).toString()}catch{}if(R.current.url!==le)try{const[Ne,Ae]=le.split("?"),ve=new URLSearchParams(Ae);ve.delete(Fe),ve.delete(gt),G({params:{preview:`${Ne}${ve.size>0?"?":""}${ve}`}})}catch{G({params:{preview:le}})}R.current={title:Se,url:le}}),A.on("visual-editing/meta",D=>{R.current.title=D.title}),A.on("visual-editing/toggle",D=>{U.send({type:"toggle visual editing overlays",enabled:D.enabled})}),A.on("visual-editing/documents",D=>{K("visual-editing",D.perspective,D.documents)}),A.on("visual-editing/refreshing",D=>{D.source==="manual"?clearTimeout(je.current):D.source==="mutation"&&U.send({type:"iframe refresh"})}),A.on("visual-editing/refreshed",()=>{U.send({type:"iframe loaded"})}),A.onStatus(ee);const W=A.start();return E(A),()=>{W(),E(null)}},[y,U,K,ee,o]),f.useEffect(()=>{if(!y)return;const A=y.createChannel({name:"presentation",connectTo:"preview-kit",heartbeat:!0},dt().provide({actors:pt()}));return A.onStatus(O),A.on("preview-kit/documents",W=>{W.projectId===F&&W.dataset===Q&&K("preview-kit",W.perspective,W.documents)}),A.start()},[y,Q,F,K,O,o]);const ne=f.useMemo(()=>mr(A=>{C(A)&&j({state:A,replace:!0})},0),[C,j]),se=f.useCallback(A=>{const W=new URL(A,o),D=W.toString();k.preview!==D&&(Array.isArray(c)?c.some(Se=>Se.test(D))&&j({params:{preview:D}}):W.origin===o&&j({params:{preview:D}}))},[o,k.preview,c,j]),T=f.useCallback(A=>{j({params:A})},[j]),V=f.useCallback(A=>{j(A)},[j]);f.useEffect(()=>{k.id&&k.path?_?.post("presentation/focus",{id:k.id,path:k.path}):_?.post("presentation/blur")},[k.id,k.path,_]),f.useEffect(()=>{if(R.current.url&&k.preview&&R.current.url!==k.preview){try{const A=new URL(R.current.url,o).origin,W=new URL(k.preview,o).origin;if(A!==W)return}catch{}if(R.current.url=k.preview,te==="connected"){let A=k.preview;if(A.startsWith("http"))try{const W=new URL(k.preview,o);A=W.pathname+W.search+W.hash}catch{}_?.post("presentation/navigate",{url:A,type:"replace"})}}},[te,o,k.preview,_]);const z=f.useCallback(()=>_?.post("presentation/toggle-overlay"),[_]),[de,_e]=f.useState(null);f.useEffect(()=>{const A=D=>{Ot(D)&&z()},W=D=>{Ot(D)&&z(),ms(["mod","\\"],D)&&z()};return window.addEventListener("keydown",W),window.addEventListener("keyup",A),()=>{window.removeEventListener("keydown",W),window.removeEventListener("keyup",A)}},[z]);const[ye,xe]=f.useState(null),[{navigatorEnabled:me,toggleNavigator:be},Pe]=ei({unstable_navigator:d}),je=f.useRef(void 0),Ce=f.useCallback(A=>{if(U.send({type:"iframe refresh"}),_){je.current=window.setTimeout(A,300),_.post("presentation/refresh",{source:"manual",livePreviewEnabled:re==="connected"||oe==="connected"});return}A()},[oe,U,re,_]),Me=zr(),ke=f.useCallback(({id:A,type:W,path:D})=>{if(R.current.url)return{title:R.current.title||R.current.url,name:"edit",params:{id:A,path:D,type:W,inspect:Nr,workspace:Me.name,mode:Wr,preview:k.preview}}},[k.preview,Me.name]),We=f.useCallback(A=>{j({params:{viewport:A==="desktop"?void 0:"mobile"},replace:!0})},[j]);return l.jsxs(l.Fragment,{children:[l.jsx(ii,{devMode:P,name:p,navigate:j,params:k,searchParams:I,structureParams:$,children:l.jsx(Ya,{navigate:j,children:l.jsx(ai,{params:k,children:l.jsx(pa,{comlink:_,children:l.jsx(us,{"data-testid":"presentation-root",height:"fill",children:l.jsxs(Sa,{children:[l.jsx(Pe,{}),l.jsx(Et,{id:"preview",minWidth:325,defaultSize:me?50:75,order:3,children:l.jsx(ie,{direction:"column",flex:1,height:"fill",ref:xe,children:l.jsx(Fr,{element:ye,children:l.jsx(Sr,{canSharePreviewAccess:w,canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:t,header:m,initialUrl:n,loadersConnection:oe,navigatorEnabled:me,onPathChange:se,onRefresh:Ce,openPopup:H,overlaysConnection:te,previewUrl:k.preview,perspective:x,ref:S,setViewport:We,targetOrigin:o,toggleNavigator:be,toggleOverlay:z,viewport:B,vercelProtectionBypass:i,presentationRef:U,previewUrlRef:s},o)})})}),l.jsx(Ja,{documentId:k.id,documentsOnPage:q,documentType:k.type,getCommentIntent:ke,mainDocumentState:J,onEditReference:V,onFocusPath:ne,onStructureParams:T,searchParams:I,setDisplayedDocument:_e,structureParams:$})]})})})})})}),l.jsxs(f.Suspense,{children:[y&&l.jsx(ns,{controller:y,perspective:x,liveDocument:de,onDocumentsOnPage:K,onLoadersConnection:ce}),_&&k.id&&k.type&&l.jsx(is,{comlink:_,id:k.id,type:k.type,loadersConnection:oe,previewKitConnection:re}),_&&l.jsx(cs,{comlink:_,perspective:x}),_&&q.length>0&&l.jsx(os,{comlink:_,perspective:x,refs:q}),_&&l.jsx(as,{comlink:_,perspective:x}),_&&l.jsx(la,{comlink:_}),_&&l.jsx(ss,{comlink:_,perspective:x}),_&&l.jsx(ls,{comlink:_})]})]})}function Ot(r){return r.key==="Alt"}const ps=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),zt={alt:"altKey",ctrl:"ctrlKey",mod:ps?"metaKey":"ctrlKey",shift:"shiftKey"};function ms(r,e){return r.every(t=>zt[t]?e[zt[t]]:e.key===t.toUpperCase())}function hs({client:r,currentUserId:e}){return pe(async()=>await sa(r,"sanity/presentation",location.href,e))}function fs({client:r}){return pe(async()=>r.fetch(sr,{},{tag:"presentation.fallback-to-shared-access-secret"}))}function vs({client:r,allowOption:e}){return pe(async({input:t})=>{const{initialUrl:a}=t;if(typeof URLPattern>"u"&&await Re(()=>import("./index-DPyTNidZ.js"),[]),!e)return[new URLPattern(a.origin)];const i=typeof e=="function"?await e({client:r,origin,initialUrl:a}):e,n=(Array.isArray(i)?i:[i]).map(s=>{const c=new URLPattern(s);if(c.hostname==="*")throw new Error("It's insecure to allow any hostname, it could disclose data to a malicious site");return c});return n.some(s=>s.test(a.origin))?n:[...n,new URLPattern(a.origin)]})}function gs({client:r,studioBasePath:e,previewUrlOption:t,perspective:a}){return pe(async({input:i})=>{const{origin:n}=location;if(typeof t=="function"){const s=await t({client:r,studioBasePath:e,previewUrlSecret:"",studioPreviewPerspective:ze(a),previewSearchParam:i.previewSearchParam});return new URL(s,n)}if(!t)return new URL("/",n);if(typeof t=="string")return new URL(t,n);if(typeof t.initial=="function"){const s=await t.initial({client:r,origin:n});return new URL(s,n)}return typeof t.initial=="string"?new URL(t.initial,n):new URL(t.preview||"/",t.origin||n)})}function ws({client:r,previewUrlOption:e}){return pe(async({input:t})=>{const{targetOrigin:a}=t;if(typeof e=="object"&&e?.draftMode)return{enable:e.draftMode.enable,shareAccess:e.draftMode.shareAccess??!0};if(!e||typeof e=="string"||typeof e=="function"||!e.previewMode)return!1;const i=typeof e.previewMode=="function"?await e.previewMode({client:r,origin,targetOrigin:a}):e.previewMode;return i===!1?!1:{enable:i.enable,shareAccess:i.shareAccess??!0}})}function ys({client:r,studioBasePath:e,previewUrlOption:t,perspective:a}){return pe(async({input:i})=>{const{previewUrlSecret:n,resolvedPreviewMode:s,initialUrl:c}=i;if(typeof t=="function"){const u=await t({client:r,studioBasePath:e,previewUrlSecret:n,studioPreviewPerspective:ze(a),previewSearchParam:c.toString()});return new URL(u,c)}if(!s)throw new Error("Resolved preview mode is false");const o=new URL(s.enable,c);return o.searchParams.set(vt,n),o.searchParams.set(Oe,ze(a)),c.pathname!==o.pathname&&o.searchParams.set(ft,`${c.pathname}${c.search}${c.hash}`),o})}const xs=pe(async({input:r})=>{const{previewSearchParam:e,initialUrl:t,allowOrigins:a}=r;if(!e)return t;try{const i=new URL(e,t.origin);return a.some(n=>n.test(i.origin))?i:t}catch{return t}}),ut={_id:Be,_type:yt},bs={_id:`drafts.${Gt()}`,_type:qt},Ps=Yt({actions:{"notify preview will likely fail":Vr("Missing permissions to create preview secret, or read shared preview secret. Preview will likely fail loading."),"assign preview search param":Y({previewSearchParam:(r,e)=>e.previewSearchParam}),"assign error":Y({error:(r,e)=>e.error instanceof Error?e.error:new Error(e.message,{cause:e.error})})},actors:{"check permission":Zt(()=>In(()=>new Error("The 'check permission' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'check permission': fromObservable(({input}: {input: CheckPermissionInput}) => ...)}})"))),"resolve initial url":pe(()=>Promise.reject(new Error("The 'resolve initial url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve initial url': fromPromise(...)}})"))),"resolve allow patterns":pe(()=>Promise.reject(new Error("The 'resolve allow patterns' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve allow pattern': fromPromise(...)}})"))),"resolve url from preview search param":xs,"resolve preview mode":pe(()=>Promise.reject(new Error("The 'resolve preview mode' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode': fromPromise(...)}})"))),"create preview secret":pe(async()=>Promise.reject(new Error("The 'create preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'create preview secret': fromPromise(...)}})"))),"read shared preview secret":pe(async()=>Promise.reject(new Error("The 'read shared preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'read shared preview secret': fromPromise(...)}})"))),"resolve preview mode url":pe(()=>Promise.reject(new Error("The 'resolve preview mode url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode url': fromPromise(...)}})")))},guards:{"has checked permissions":({context:r})=>!!(r.previewAccessSharingCreatePermission&&r.previewAccessSharingReadPermission&&r.previewAccessSharingUpdatePermission&&r.previewUrlSecretPermission),"search param has new origin":({context:r,event:e})=>{if(!r.previewUrl||!e.previewSearchParam)return!1;try{const t=new URL(e.previewSearchParam,r.previewUrl);return r.previewUrl.origin!==t.origin}catch{return!1}},"can create preview secret":({context:r})=>r.previewUrlSecretPermission?.granted===!0,"has preview mode with created secret":({context:r},e)=>e===!1?!1:r.previewUrlSecretPermission?.granted===!0,"has preview mode with share access":({context:r},e)=>e===!1?!1:r.previewAccessSharingReadPermission?.granted===!0,"has preview mode without permissions":({context:r},e)=>e===!1?!1:r.previewAccessSharingReadPermission?.granted===!1&&r.previewUrlSecretPermission?.granted===!1},delays:{expiredSecret:({context:r})=>{if(!r.previewUrlSecret?.expiresAt)return 0;const e=Date.now(),t=r.previewUrlSecret.expiresAt.getTime();return Math.max(t-e,0)}}}).createMachine({id:"Preview URL",context:({input:r})=>({initialUrl:null,previewUrl:null,error:null,allowOrigins:null,previewSearchParam:r.previewSearchParam,previewUrlSecret:null,previewAccessSharingCreatePermission:null,previewAccessSharingReadPermission:null,previewAccessSharingUpdatePermission:null,previewUrlSecretPermission:null,previewMode:null}),invoke:[{src:"check permission",input:()=>({checkPermissionName:"read",document:ut}),onError:{target:".error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to check permission",error:r.error})}},onSnapshot:{actions:Y({previewAccessSharingReadPermission:({event:r})=>r.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"create",document:ut}),onError:{target:".error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to check permission",error:r.error})}},onSnapshot:{actions:Y({previewAccessSharingCreatePermission:({event:r})=>r.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"update",document:ut}),onError:{target:".error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to check permission",error:r.error})}},onSnapshot:{actions:Y({previewAccessSharingUpdatePermission:({event:r})=>r.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"create",document:bs}),onError:{target:".error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to check permission",error:r.error})}},onSnapshot:{actions:Y({previewUrlSecretPermission:({event:r})=>r.snapshot.context??null})}}],on:{"set preview search param":{actions:{type:"assign preview search param",params:({event:r})=>({previewSearchParam:r.previewSearchParam})}}},states:{checkingPermissions:{always:{guard:"has checked permissions",target:"resolvingInitialUrl"},tags:"busy"},resolvingInitialUrl:{invoke:{src:"resolve initial url",input:({context:r})=>({previewSearchParam:r.previewSearchParam}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve initial url",error:r.error})}},onDone:{target:"resolvingAllowPatterns",actions:Y({initialUrl:({event:r})=>r.output})}},tags:"busy"},error:{type:"final",tags:"error"},resolvingAllowPatterns:{invoke:{src:"resolve allow patterns",input:({context:r})=>({initialUrl:r.initialUrl}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve preview url allow patterns",error:r.error})}},onDone:{target:"resolvingUrlFromPreviewSearchParam",actions:Y({allowOrigins:({event:r})=>r.output})}},tags:["busy"]},resolvingUrlFromPreviewSearchParam:{id:"loop",invoke:{src:"resolve url from preview search param",input:({context:r})=>({initialUrl:r.initialUrl,allowOrigins:r.allowOrigins,previewSearchParam:r.previewSearchParam}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve preview url from search param",error:r.error})}},onDone:{target:"resolvingPreviewMode",actions:Y({initialUrl:({event:r})=>r.output})}},tags:["busy"]},resolvingPreviewMode:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:r})=>({previewSearchParam:r.previewSearchParam})},target:"#loop",reenter:!0}},invoke:{src:"resolve preview mode",input:({context:r})=>({targetOrigin:r.initialUrl.origin}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve preview url allow patterns",error:r.error})}},onDone:[{guard:{type:"has preview mode with created secret",params:({event:r})=>r.output},actions:Y({previewMode:({event:r})=>r.output}),target:"previewMode.createPreviewSecret"},{guard:{type:"has preview mode with share access",params:({event:r})=>r.output},actions:Y({previewMode:({event:r})=>r.output}),target:"previewMode.readShareAccess"},{guard:{type:"has preview mode without permissions",params:({event:r})=>r.output},actions:[Y({previewUrl:({context:r})=>r.initialUrl}),"notify preview will likely fail"],target:"success"},{actions:Y({previewUrl:({context:r})=>r.initialUrl}),target:"success"}]},tags:["busy"]},success:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:r})=>({previewSearchParam:r.previewSearchParam})},target:"#loop",reenter:!0}}},previewMode:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:r})=>({previewSearchParam:r.previewSearchParam})},target:"#loop",reenter:!0}},states:{createPreviewSecret:{invoke:{src:"create preview secret",onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to create preview secret",error:r.error})}},onDone:{target:"resolvePreviewUrl",actions:Y({previewUrlSecret:({event:r})=>r.output})}},tags:["busy"]},readShareAccess:{invoke:{src:"read shared preview secret",onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to read shared preview secret",error:r.error})}},onDone:{target:"resolvePreviewUrl",actions:Y({previewUrlSecret:({event:r})=>({secret:r.output,expiresAt:new Date(Date.now()+1e3*60*60*60*24)})})}},tags:["busy"]},resolvePreviewUrl:{invoke:{src:"resolve preview mode url",input:({context:r})=>({initialUrl:r.initialUrl,resolvedPreviewMode:r.previewMode,previewUrlSecret:r.previewUrlSecret.secret}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve preview url",error:r.error})}},onDone:{target:"success",actions:Y({previewUrl:({event:r})=>r.output})}},tags:["busy"]},error:{type:"final",tags:["error"]},success:{after:{expiredSecret:{guard:"can create preview secret",actions:Y({previewUrlSecret:null}),target:"createPreviewSecret",reenter:!0}}}},initial:"readShareAccess"}},initial:"checkingPermissions"});function Ss(r,e){const t=L.c(24),a=$r();let i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i={apiVersion:nt},t[0]=i):i=t[0];const n=et(i),s=Xt()?.id,c=Jt()?.activeWorkspace?.basePath||"/",o=Ke();let u;t[1]!==o.state._searchParams?(u=new URLSearchParams(o.state._searchParams).get("preview"),t[1]=o.state._searchParams,t[2]=u):u=t[2];const p=u,{push:d}=tt(),{t:m}=ge(we),h=Er();let v;if(t[3]!==e||t[4]!==n||t[5]!==s||t[6]!==a||t[7]!==h||t[8]!==r||t[9]!==d||t[10]!==c||t[11]!==m){let y;t[13]!==d||t[14]!==m?(y=()=>d({id:"preview-url-secret.missing-grants",closable:!0,status:"error",duration:1/0,title:m("preview-url-secret.missing-grants")}),t[13]=d,t[14]=m,t[15]=y):y=t[15];let b;t[16]!==a?(b=_=>{const{input:E}=_;return a.checkDocumentPermission(E.checkPermissionName,E.document)},t[16]=a,t[17]=b):b=t[17],v=Ps.provide({actions:{"notify preview will likely fail":y},actors:{"create preview secret":hs({client:n,currentUserId:s}),"read shared preview secret":fs({client:n}),"resolve allow patterns":vs({client:n,allowOption:e}),"resolve initial url":gs({client:n,studioBasePath:c,previewUrlOption:r,perspective:h}),"resolve preview mode":ws({client:n,previewUrlOption:r}),"resolve preview mode url":ys({client:n,studioBasePath:c,previewUrlOption:r,perspective:h}),"check permission":Zt(b)}}),t[3]=e,t[4]=n,t[5]=s,t[6]=a,t[7]=h,t[8]=r,t[9]=d,t[10]=c,t[11]=m,t[12]=v}else v=t[12];let g;t[18]!==p?(g={input:{previewSearchParam:p}},t[18]=p,t[19]=g):g=t[19];const x=er(v,g);let w,P;t[20]!==x||t[21]!==p?(w=()=>{x.send({type:"set preview search param",previewSearchParam:p})},P=[x,p],t[20]=x,t[21]=p,t[22]=w,t[23]=P):(w=t[22],P=t[23]),f.useEffect(w,P);const S=X(x,_s);if(S)throw S;return x}function _s(r){return r.status==="error"?r.error:r.hasTag("error")?r.context.error:null}function js(r){const e=L.c(9),{t}=ge(we),{push:a}=tt(),i=Ke();let n;e[0]!==i.state._searchParams?(n=new URLSearchParams(i.state._searchParams).get("preview"),e[0]=i.state._searchParams,e[1]=n):n=e[1];const s=n,c=X(r,Rs),o=X(r,Es);let u,p;e[2]!==c||e[3]!==o||e[4]!==s||e[5]!==a||e[6]!==t?(u=()=>{if(!Array.isArray(c)||!s||!o)return;const d=new URL(s,o).origin;c.some(m=>m.test(d))||a({closable:!0,id:`presentation-iframe-origin-mismatch-${d}`,status:"error",duration:1/0,title:t("preview-search-param.configuration.error.title"),description:l.jsx(_t,{t,i18nKey:"preview-search-param.configuration.error.description",components:{Code:"code"},values:{previewSearchParam:s,blockedOrigin:d}})})},p=[c,o,s,a,t],e[2]=c,e[3]=o,e[4]=s,e[5]=a,e[6]=t,e[7]=u,e[8]=p):(u=e[7],p=e[8]),f.useEffect(u,p)}function Es(r){return r.context.previewUrl?.origin}function Rs(r){return r.context.allowOrigins}function Cs(){const r=L.c(7);let e;r[0]===Symbol.for("react.memo_cache_sentinel")?(e={apiVersion:nt},r[0]=e):e=r[0];const t=et(e),[a,i]=f.useReducer(ks,"loading"),[n,s]=f.useState(null);let c,o;r[1]!==t?(c=()=>{const p=oa(t,d=>{s(d),i()});return()=>p()},o=[t],r[1]=t,r[2]=c,r[3]=o):(c=r[2],o=r[3]),f.useEffect(c,o);let u;return r[4]!==a||r[5]!==n?(u=[n,a],r[4]=a,r[5]=n,r[6]=u):u=r[6],u}function ks(){return"ready"}function As(r){const e=L.c(8),{tool:t}=r,a=Ss(t.options?.previewUrl,t.options?.allowOrigins);js(a);const i=X(a,$s),n=X(a,Us),s=X(a,Is),c=X(a,Ms),o=X(a,Ts),[u,p]=Cs();if(!o||p==="loading"||!i||typeof i.granted>"u"||!n||typeof n.granted>"u"||!c||!s||typeof s.granted>"u"||typeof c.granted>"u"){let v;return e[0]===Symbol.for("react.memo_cache_sentinel")?(v=l.jsx(Qt,{}),e[0]=v):v=e[0],v}const d=i?.granted===!0&&n?.granted===!0,m=s?.granted===!0;let h;return e[1]!==a||e[2]!==d||e[3]!==m||e[4]!==t||e[5]!==o||e[6]!==u?(h=l.jsx(ds,{tool:t,initialPreviewUrl:o,vercelProtectionBypass:u,canToggleSharePreviewAccess:d,canUseSharedPreviewAccess:m,previewUrlRef:a}),e[1]=a,e[2]=d,e[3]=m,e[4]=t,e[5]=o,e[6]=u,e[7]=h):h=e[7],h}function Ts(r){return r.context.previewUrl}function Ms(r){return r.context.previewUrlSecretPermission}function Is(r){return r.context.previewAccessSharingReadPermission}function Us(r){return r.context.previewAccessSharingUpdatePermission}function $s(r){return r.context.previewAccessSharingCreatePermission}const Os=Object.freeze(Object.defineProperty({__proto__:null,default:As},Symbol.toStringTag,{value:"Module"}));export{Os as P,pt as c};
